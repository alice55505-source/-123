const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VideoPreview-B07A5-Mx.js","assets/vendor--FBYh3JU.js"])))=>i.map(i=>d[i]);
import{r as p,j as e,R as Ie,c as Ye}from"./vendor--FBYh3JU.js";(function(){const E=document.createElement("link").relList;if(E&&E.supports&&E.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))g(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&g(u)}).observe(document,{childList:!0,subtree:!0});function N(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function g(i){if(i.ep)return;i.ep=!0;const c=N(i);fetch(i.href,c)}})();const Xe="modulepreload",Ke=function(l){return"/"+l},Le={},Ee=function(E,N,g){let i=Promise.resolve();if(N&&N.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));i=Promise.allSettled(N.map(j=>{if(j=Ke(j),j in Le)return;Le[j]=!0;const P=j.endsWith(".css"),M=P?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${j}"]${M}`))return;const w=document.createElement("link");if(w.rel=P?"stylesheet":Xe,P||(w.as="script"),w.crossOrigin="",w.href=j,f&&w.setAttribute("nonce",f),document.head.appendChild(w),P)return new Promise((L,R)=>{w.addEventListener("load",L),w.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${j}`)))})}))}function c(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return i.then(u=>{for(const f of u||[])f.status==="rejected"&&c(f.reason);return E().catch(c)})};var G=(l=>(l.FADE="FADE",l.SLIDE_UP="SLIDE_UP",l.SLIDE_DOWN="SLIDE_DOWN",l.SLIDE_LEFT="SLIDE_LEFT",l.SLIDE_RIGHT="SLIDE_RIGHT",l.ZOOM_IN="ZOOM_IN",l.RANDOM="RANDOM",l))(G||{}),K=(l=>(l.IDLE="IDLE",l.COLLAGE="COLLAGE",l.EDITING="EDITING",l.RENDERING="RENDERING",l.FINISHED="FINISHED",l))(K||{});const qe=({item:l,settings:E,selectedOverlayId:N,setSelectedOverlayId:g,onUpdate:i,isCropMode:c})=>{const u=p.useRef(null),f=p.useRef({}),j=p.useRef(""),[P,M]=p.useState(0),[w,L]=p.useState("NONE"),[R,q]=p.useState(null),[$,te]=p.useState({x:0,y:0}),[F,oe]=p.useState(null),z=E.resolution.width,W=E.resolution.height;p.useEffect(()=>{if(l.file||!u.current)return;const b=setInterval(()=>{if(w!=="NONE")return;const s=u.current.toDataURL("image/jpeg",.3);s.length!==j.current.length&&(j.current=s,i({previewUrl:s}))},2e3);return()=>clearInterval(b)},[l.id,l.file,i,w]),p.useEffect(()=>{const b=[];if(l.file&&l.previewUrl&&!f.current[l.previewUrl]&&b.push({key:l.previewUrl,url:l.previewUrl,type:l.type}),l.overlays.forEach(a=>{a.type==="image"&&a.sourceUrl&&!f.current[a.sourceUrl]&&b.push({key:a.sourceUrl,url:a.sourceUrl,type:"image"})}),b.length===0)return;let s=0;b.forEach(a=>{if(a.type==="video"){const m=document.createElement("video");m.src=a.url,m.muted=!0,m.onloadeddata=()=>{f.current[a.key]=m,s++,s===b.length&&M(k=>k+1)},m.onerror=()=>{s++,s===b.length&&M(k=>k+1)},m.load()}else{const m=new Image;m.src=a.url,m.onload=()=>{f.current[a.key]=m,s++,s===b.length&&M(k=>k+1)},m.onerror=()=>{s++,s===b.length&&M(k=>k+1)}}})},[l.id,l.overlays.length,l.type,l.file]);const pe=b=>{var m,k;return`${((m=b.fontFamily)==null?void 0:m.includes("KaiTi"))||((k=b.fontFamily)==null?void 0:k.includes("Noto"))?"bold":"normal"} ${b.fontSize}px ${b.fontFamily}`},se=(b,s)=>{let a=s.width,m=s.height;if(s.type==="text"){b.font=pe(s);const k=b.measureText(s.text||""),x=s.backgroundPadding||0;a=k.width+x*2,m=(s.fontSize||60)+x*2}return{w:a,h:m}},me=p.useCallback(()=>{const b=u.current;if(!b)return;const s=b.getContext("2d");if(s){if(s.clearRect(0,0,z,W),l.file){s.fillStyle="#0b0e14",s.fillRect(0,0,z,W);const a=f.current[l.previewUrl];if(a){const m=a instanceof HTMLVideoElement?a.videoWidth:a.width,k=a instanceof HTMLVideoElement?a.videoHeight:a.height;if(m>0&&k>0){const x=Math.max(z/m,W/k),y=m*x,h=k*x;s.drawImage(a,(z-y)/2,(W-h)/2,y,h)}}}else if(l.gradientColors){const a=s.createLinearGradient(0,0,z,W);a.addColorStop(0,l.gradientColors.start),a.addColorStop(1,l.gradientColors.end),s.fillStyle=a,s.fillRect(0,0,z,W)}else s.fillStyle="#1e293b",s.fillRect(0,0,z,W);[...l.overlays].sort((a,m)=>a.zIndex-m.zIndex).forEach(a=>{s.save();const{w:m,h:k}=se(s,a),x=m*a.scale,y=k*a.scale;if(s.translate(a.x+x/2,a.y+y/2),s.rotate(a.rotation),s.translate(-x/2,-y/2),a.type==="image"){const h=a.sourceUrl?f.current[a.sourceUrl]:null;if(h){const d=a.crop||{t:0,b:0,l:0,r:0},A=h.width*d.l,B=h.height*d.t,Y=h.width*(1-d.l-d.r),I=h.height*(1-d.t-d.b);s.drawImage(h,A,B,Y,I,0,0,x,y)}}else if(a.type==="text"){const h=a.backgroundPadding||0;a.backgroundColor&&(s.fillStyle=a.backgroundColor,s.globalAlpha=a.backgroundOpacity||.7,s.beginPath(),s.roundRect(0,0,x,y,a.backgroundRadius||10),s.fill()),s.globalAlpha=1,s.save(),s.scale(a.scale,a.scale),s.font=pe(a),s.textBaseline="top",a.strokeColor&&(a.strokeWidth||0)>0&&(s.strokeStyle=a.strokeColor,s.lineWidth=(a.strokeWidth||0)*2,s.lineJoin="round",s.strokeText(a.text||"",h,h)),s.fillStyle=a.color||"#fff",s.fillText(a.text||"",h,h),s.restore()}else a.type==="sticker"&&(s.font=`${y}px sans-serif`,s.textAlign="center",s.textBaseline="middle",s.fillText(a.emoji||"",x/2,y/2));N===a.id&&(s.strokeStyle=c?"#ef4444":"#6366f1",s.lineWidth=4,s.setLineDash(c?[]:[10,5]),s.strokeRect(-2,-2,x+4,y+4),s.setLineDash([]),c&&a.type==="image"?(s.fillStyle="#ef4444",[[0,0,"tl"],[x,0,"tr"],[x,y,"br"],[0,y,"bl"]].forEach(([h,d])=>{s.beginPath(),s.arc(h,d,10,0,Math.PI*2),s.fill()})):c||(s.fillStyle="#6366f1",s.beginPath(),s.arc(x,y,12,0,Math.PI*2),s.fill(),s.fillStyle="#10b981",s.beginPath(),s.arc(x/2,-40,12,0,Math.PI*2),s.fill())),s.restore()})}},[l,N,z,W,P,c]);p.useEffect(()=>{me()},[me]);const ie=b=>{const s=u.current.getBoundingClientRect();let a=0,m=0;return"touches"in b?(a=b.touches[0].clientX,m=b.touches[0].clientY):(a=b.clientX,m=b.clientY),{x:(a-s.left)*(z/s.width),y:(m-s.top)*(W/s.height)}},ce=b=>{const{x:s,y:a}=ie(b),m=u.current.getContext("2d");if(N){const x=l.overlays.find(B=>B.id===N),{w:y,h}=se(m,x),d=y*x.scale,A=h*x.scale;if(c&&x.type==="image"){const B=x.x+d/2,Y=x.y+A/2,I=-x.rotation,D=s-B,T=a-Y,_=D*Math.cos(I)-T*Math.sin(I)+d/2,S=D*Math.sin(I)+T*Math.cos(I)+A/2,J=[{x:0,y:0,id:"tl"},{x:d,y:0,id:"tr"},{x:d,y:A,id:"br"},{x:0,y:A,id:"bl"}];for(const V of J)if(Math.hypot(_-V.x,S-V.y)<40){L("CROP"),q(V.id),te({x:s,y:a}),oe({...x});return}}else if(!c){const B=x.x+d/2,Y=x.y+A/2,I=-x.rotation,D=s-B,T=a-Y,_=D*Math.cos(I)-T*Math.sin(I)+d/2,S=D*Math.sin(I)+T*Math.cos(I)+A/2;if(Math.hypot(_-d,S-A)<40){L("SCALE"),te({x:s,y:a}),oe({...x});return}if(Math.hypot(_-d/2,S+40)<40){L("ROTATE"),te({x:s,y:a}),oe({...x});return}}}const k=[...l.overlays].reverse().find(x=>{const{w:y,h}=se(m,x),d=y*x.scale,A=h*x.scale,B=x.x+d/2,Y=x.y+A/2,I=-x.rotation,D=s-B,T=a-Y,_=D*Math.cos(I)-T*Math.sin(I)+d/2,S=D*Math.sin(I)+T*Math.cos(I)+A/2;return _>=0&&_<=d&&S>=0&&S<=A});k?(g(k.id),L("MOVE"),te({x:s,y:a}),oe({...k})):g(null)},X=b=>{if(w==="NONE"||!N||!F)return;"touches"in b&&b.cancelable&&b.preventDefault();const{x:s,y:a}=ie(b),m=s-$.x,k=a-$.y,x=l.overlays.map(y=>{if(y.id!==N)return y;if(w==="MOVE")return{...y,x:F.x+m,y:F.y+k};if(w==="SCALE"){const h=(m+k)/400;return{...y,scale:Math.max(.1,F.scale+h)}}if(w==="ROTATE"){const h=y.x+se(u.current.getContext("2d"),y).w*y.scale/2,d=y.y+se(u.current.getContext("2d"),y).h*y.scale/2;return{...y,rotation:Math.atan2(a-d,s-h)+Math.PI/2}}if(w==="CROP"){const h=-F.rotation,d=m*Math.cos(h)-k*Math.sin(h),A=m*Math.sin(h)+k*Math.cos(h),B=F.width,Y=F.height,I=F.scale,D=F.crop||{t:0,b:0,l:0,r:0},T=B/(1-D.l-D.r),_=Y/(1-D.t-D.b);let S={...D},J=0,V=0;if(R!=null&&R.includes("l")){const ee=d/(T*I);S.l=Math.min(.9,Math.max(0,D.l+ee)),J=(S.l-D.l)*T*I}else if(R!=null&&R.includes("r")){const ee=-d/(T*I);S.r=Math.min(.9,Math.max(0,D.r+ee))}if(R!=null&&R.includes("t")){const ee=A/(_*I);S.t=Math.min(.9,Math.max(0,D.t+ee)),V=(S.t-D.t)*_*I}else if(R!=null&&R.includes("b")){const ee=-A/(_*I);S.b=Math.min(.9,Math.max(0,D.b+ee))}const Q=T*(1-S.l-S.r),de=_*(1-S.t-S.b),re=F.rotation,we=J*Math.cos(re)-V*Math.sin(re),ge=J*Math.sin(re)+V*Math.cos(re);return{...y,crop:S,width:Q,height:de,x:F.x+we,y:F.y+ge}}return y});i({overlays:x})},Z=()=>{L("NONE")};return e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black overflow-hidden touch-none",children:e.jsx("canvas",{ref:u,width:z,height:W,onMouseDown:ce,onMouseMove:X,onMouseUp:Z,onMouseLeave:Z,onTouchStart:ce,onTouchMove:X,onTouchEnd:Z,className:"max-w-full max-h-full object-contain cursor-crosshair touch-none"})})},Ue=[{name:"Ê®ôÊ•∑È´î (KaiTi)",value:'"DFKai-SB", "KaiTi", serif'},{name:"ËÉñËÉñÈ´î (Mochiy)",value:'"Mochiy Pop One", sans-serif'},{name:"Á≤âÂúìÈ´î (Huninn)",value:'"jf-openhuninn-1.1", sans-serif'},{name:"Á´•Á´•È´î (Marker)",value:'"LXGW Marker Gothic", sans-serif'},{name:"ÈªûÈô£È´î (Pixel)",value:'"DotGothic16", sans-serif'},{name:"ÈªëÈ´î (Noto Sans)",value:'"Noto Sans TC", sans-serif'}],Je=["‚ù§Ô∏è","‚≠ê","üî•","‚ú®","üçÄ","üé®","üöÄ","üì∑","üí°","üåà","üê±","üê∂"],Me=l=>new Promise((E,N)=>{const g=new Image;g.crossOrigin="anonymous",g.onload=()=>{const i=document.createElement("canvas"),c=1280;let u=g.width,f=g.height;u>c&&(f*=c/u,u=c),i.width=u,i.height=f,i.getContext("2d").drawImage(g,0,0,u,f);try{E(i.toDataURL("image/jpeg",.7))}catch(P){console.warn("CORS compression failed, using original URL",P),E(l)}},g.onerror=()=>{E(l)},g.src=l}),Ze=l=>new Promise((E,N)=>{const g=document.createElement("video");g.src=l,g.muted=!0,g.crossOrigin="anonymous",g.onloadedmetadata=()=>{const i=document.createElement("canvas");i.width=640,i.height=360;const c=i.getContext("2d"),u=i.captureStream(24),f=new MediaRecorder(u,{mimeType:"video/webm;codecs=vp8",videoBitsPerSecond:1e6}),j=[];f.ondataavailable=M=>j.push(M.data),f.onstop=()=>{const M=new Blob(j,{type:"video/webm"}),w=new FileReader;w.onloadend=()=>E(w.result),w.readAsDataURL(M)},g.play(),f.start();const P=()=>{if(g.paused||g.ended){f.stop();return}c.drawImage(g,0,0,i.width,i.height),requestAnimationFrame(P)};P()},g.onerror=()=>E(l)}),Qe=l=>typeof l=="string"?Promise.resolve(l):new Promise((E,N)=>{const g=new FileReader;g.onload=()=>E(g.result),g.onerror=N,g.readAsDataURL(l)}),et=async(l,E,N,g)=>{const i=E.length+N.length;let c=0;const u=[];for(const L of E){let R="";try{L.type==="video"?R=await Ze(L.previewUrl):R=await Me(L.previewUrl)}catch($){console.error("Failed to compress asset",L.id,$),R=L.previewUrl}const q=[];for(const $ of L.overlays)if($.type==="image"&&$.sourceUrl){const te=await Me($.sourceUrl);q.push({...$,sourceUrl:te})}else q.push($);u.push({...L,previewUrl:R,overlays:q,file:void 0}),c++,g(Math.floor(c/i*100))}const f=[];for(const L of N){const R=await Qe(L.url);f.push({...L,url:R,file:void 0}),c++,g(Math.floor(c/i*100))}const j={version:"1.0",settings:l,media:u,audioTracks:f},P=new Blob([JSON.stringify(j)],{type:"application/json"}),M=URL.createObjectURL(P),w=document.createElement("a");w.href=M,w.download=`${l.outputFileName}_project.ezp`,w.click(),URL.revokeObjectURL(M)},tt=async l=>new Promise((E,N)=>{const g=new FileReader;g.onload=async i=>{var c;try{const u=JSON.parse((c=i.target)==null?void 0:c.result);u.media=u.media.map(f=>{const j=Ne(f.previewUrl),P=URL.createObjectURL(j),M=f.overlays.map(w=>{if(w.type==="image"&&w.sourceUrl){const L=Ne(w.sourceUrl);return{...w,sourceUrl:URL.createObjectURL(L)}}return w});return{...f,previewUrl:P,overlays:M}}),u.audioTracks=u.audioTracks.map(f=>{const j=Ne(f.url);return{...f,url:URL.createObjectURL(j)}}),E(u)}catch(u){N(u)}},g.onerror=N,g.readAsText(l)});function Ne(l){if(!l.startsWith("data:"))return console.warn("Found non-data URI in project file, treating as text content",l),new Blob([l],{type:"text/plain"});const E=atob(l.split(",")[1]),N=l.split(",")[0].split(":")[1].split(";")[0],g=new ArrayBuffer(E.length),i=new Uint8Array(g);for(let c=0;c<E.length;c++)i[c]=E.charCodeAt(c);return new Blob([g],{type:N})}const st=Ie.lazy(()=>Ee(()=>import("./VideoPreview-B07A5-Mx.js"),__vite__mapDeps([0,1]))),rt="208217318300-e58p9c688o3n0f11rpm9bnntnhqrp18a.apps.googleusercontent.com",at="AIzaSyAo41JycYePmA6kE841jJ9-fk4BUMKLao8",nt=rt,lt=at,ot={[G.FADE]:"Ê∑°ÂÖ•Ê∑°Âá∫",[G.SLIDE_UP]:"Âêë‰∏äÊªëÂãï",[G.SLIDE_DOWN]:"Âêë‰∏ãÊªëÂãï",[G.SLIDE_LEFT]:"ÂêëÂ∑¶ÊªëÂãï",[G.SLIDE_RIGHT]:"ÂêëÂè≥ÊªëÂãï",[G.ZOOM_IN]:"Á∏ÆÊîæÈÄ≤ÂÖ•",[G.RANDOM]:"Èö®Ê©üËΩâÂ†¥"},ke=[{name:"Êô®ÈúßÁÅ∞",start:"#e8eaeb",end:"#9ca6a9"},{name:"Êùè‰ªÅÁôΩ",start:"#f6f0ea",end:"#d0b8ac"},{name:"Èº†Â∞æËçâ",start:"#e6ebe0",end:"#9bc4bc"},{name:"ÈùúË¨êËóç",start:"#e0e7eb",end:"#9fb8cd"},{name:"‰πæÁá•Áé´Áë∞",start:"#f5e6e8",end:"#d4a5a5"},{name:"ÊöñÊ≤ôÈáë",start:"#fdfbf7",end:"#d4c5b0"},{name:"Ê•µÁ∞°Èªë",start:"#2c3e50",end:"#000000"},{name:"Á¥îÊ∑®ÁôΩ",start:"#ffffff",end:"#f0f0f0"}],it=()=>{const[l,E]=p.useState(K.EDITING),[N,g]=p.useState("media"),[i,c]=p.useState([]),[u,f]=p.useState([]),[j,P]=p.useState(null),[M,w]=p.useState(null),[L,R]=p.useState(0),[q,$]=p.useState([]),[te,F]=p.useState(!1),[oe,z]=p.useState(!1),[W,pe]=p.useState([]),[se,me]=p.useState(null),[ie,ce]=p.useState(!1),[X,Z]=p.useState(null),[b,s]=p.useState(!1),[a,m]=p.useState(0),[k,x]=p.useState(!1),[y,h]=p.useState(!1),[d,A]=p.useState({outputFileName:"ÊàëÁöÑÁ≤æÂΩ©ÂΩ±Áâá",aspectRatio:"16:9",photoDuration:3,transitionDuration:1,resolution:{width:1280,height:720},collageTitle:"ÊàëÁöÑÁ≤æÂΩ©ÂõûÊÜ∂",defaultTransition:G.RANDOM}),B=p.useRef(null),Y=p.useRef(null),I=p.useRef(null),D=p.useRef(null),T=p.useRef(null),_=p.useRef(null),[S,J]=p.useState(null),V=p.useRef(null),Q=p.useRef(null);p.useEffect(()=>{w(null),s(!1)},[j]),p.useEffect(()=>{if(j){const t=i.findIndex(r=>r.id===j);t!==-1&&t!==L&&R(t)}},[i,j]);const de=()=>new Promise((t,r)=>{if(window.google&&window.google.picker){t();return}if(!window.gapi){r(new Error("Google API script (gapi) not found"));return}window.gapi.load("picker",{callback:()=>{window.google&&window.google.picker?t():r(new Error("Picker script loaded but window.google.picker is undefined"))},onerror:()=>r(new Error("Failed to load Google Picker script"))})});p.useEffect(()=>{const t=()=>{if(window.google&&window.google.accounts&&!V.current)try{V.current=google.accounts.oauth2.initTokenClient({client_id:nt,scope:"https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/photoslibrary.readonly",callback:n=>{if(n.error){console.error("Google Auth Error:",n),h(!1),alert(`Google ÁôªÂÖ•Â§±Êïó (${n.error})„ÄÇ
Ë´ãÁ¢∫‰øùÊÇ®Â∑≤Âú® Google Cloud Console Â∞áËá™Â∑±ÁöÑ Email Âä†ÂÖ•„ÄåÊ∏¨Ë©¶‰ΩøÁî®ËÄÖ„Äç„ÄÇ`);return}n.access_token?(J(n.access_token),Q.current==="photos_custom"?(z(!0),re(n.access_token),Q.current=null,h(!1)):Q.current?(Re(n.access_token,Q.current),Q.current=null):h(!1)):h(!1)}})}catch(n){console.error("Token Client init failed:",n)}};window.gapi&&de().catch(n=>console.log("Picker preload:",n));const r=setInterval(()=>{window.google&&window.google.accounts&&!V.current&&t(),V.current&&clearInterval(r)},500);return()=>clearInterval(r)},[]);const re=async(t,r)=>{var n;ce(!0),Z(null);try{let o="https://photoslibrary.googleapis.com/v1/mediaItems?pageSize=24";r&&(o+=`&pageToken=${r}`);const v=await fetch(o,{headers:{Authorization:`Bearer ${t}`}});if(!v.ok){const O=await v.json();throw new Error(((n=O.error)==null?void 0:n.message)||"Failed to fetch photos")}const U=await v.json();pe(O=>r?[...O,...U.mediaItems||[]]:U.mediaItems||[]),me(U.nextPageToken||null)}catch(o){console.error("Photos API Error:",o);const v=o.message&&(o.message.includes("insufficient authentication scopes")||o.message.includes("PERMISSION_DENIED")),U=o.message&&o.message.includes("Photos Library API has not been used");v?(J(null),Z("scope_error"),alert(`„ÄêÊ¨äÈôê‰∏çË∂≥„ÄëGoogle ÊãíÁµïÂ≠òÂèñÁõ∏Á∞ø„ÄÇ

Ë´ãÈªûÊìäË¶ñÁ™ó‰∏≠ÁöÑ„ÄåÈáçÊñ∞ÊéàÊ¨ä„ÄçÊåâÈàïÔºå‰∏¶Âú® Google ÁôªÂÖ•Áï´Èù¢ÂãæÈÅ∏ÊâÄÊúâÊ¨äÈôê„ÄÇ`)):U?(Z("api_error"),alert(`„ÄêAPI Êú™ÂïüÁî®„Äë
Ë´ãÂâçÂæÄ Google Cloud Console ÂïüÁî®„ÄåPhotos Library API„ÄçÔºåÂê¶ÂâáÁÑ°Ê≥ïËÆÄÂèñÁõ∏Á∞ø„ÄÇ`)):(Z(o.message),alert(`ËÆÄÂèñÂ§±ÊïóÔºö${o.message}`))}finally{ce(!1)}},we=async t=>{var r;h(!0);try{const n=`${t.baseUrl}=w2048-h2048`;let o=n;try{const O=await fetch(n,{mode:"cors"});if(O.ok){const le=await O.blob();o=URL.createObjectURL(le)}else console.warn("Direct fetch failed, using URL fallback")}catch(O){console.warn("CORS fetch failed, using URL fallback",O)}const v=(r=t.mediaMetadata)==null?void 0:r.video,U={id:crypto.randomUUID(),type:v?"video":"image",fileName:t.filename||"Google Photo",previewUrl:o,duration:v?5:d.photoDuration,transition:d.defaultTransition,overlays:[]};c(O=>[...O,U]),f(O=>[U,...O]),z(!1)}catch(n){console.error("Failed to process photo",n),alert("ËôïÁêÜÁÖßÁâáÊôÇÁôºÁîüÈåØË™§ÔºåË´ãÈáçË©¶„ÄÇ")}finally{h(!1)}},ge=async t=>{var n;const r=t==="photos"&&X==="scope_error";if(h(!0),t==="drive")try{await de()}catch{alert("Google Picker ÁÑ°Ê≥ïËºâÂÖ•"),h(!1);return}S&&!r?t==="drive"?Re(S):(z(!0),h(!1),W.length===0&&re(S)):(Q.current=t==="drive"?"docs":"photos_custom",(n=V.current)==null||n.requestAccessToken({prompt:"consent"}))},ee=()=>{var t;Z(null),J(null),Q.current="photos_custom",(t=V.current)==null||t.requestAccessToken({prompt:"consent"})},Re=async(t,r)=>{try{(!window.google||!window.google.picker)&&await de();const n="image/png,image/jpeg,image/jpg,video/mp4,video/quicktime",o=new google.picker.PickerBuilder().setOAuthToken(t).setDeveloperKey(lt).setOrigin(window.location.origin).setCallback(async U=>{var O,le,be;if(U.action===google.picker.Action.PICKED){h(!0);const he=U.docs,fe=[];for(const H of he)try{const ye=H.id;let ve="",xe=null;try{const ne=await fetch(`https://www.googleapis.com/drive/v3/files/${ye}?alt=media`,{headers:{Authorization:`Bearer ${t}`}});ne.ok&&(xe=await ne.blob())}catch(ne){console.warn("Drive download error",ne)}if(xe){if(((O=H.mimeType)==null?void 0:O.includes("heic"))||H.name.toLowerCase().endsWith(".heic"))try{const je=await(await Ee(()=>import("./vendor--FBYh3JU.js").then(Ve=>Ve.h),[])).default({blob:xe,toType:"image/jpeg"});xe=Array.isArray(je)?je[0]:je}catch(Pe){console.error("HEIC err",Pe)}ve=URL.createObjectURL(xe)}else(be=(le=H.thumbnails)==null?void 0:le[0])!=null&&be.url&&(ve=H.thumbnails[H.thumbnails.length-1].url);if(ve){const ne=H.mimeType&&H.mimeType.startsWith("video/");fe.push({id:crypto.randomUUID(),type:ne?"video":"image",fileName:H.name||"Drive File",previewUrl:ve,duration:ne?5:d.photoDuration,transition:d.defaultTransition,overlays:[]})}}catch(ye){console.error("Failed to process file:",ye)}c(H=>[...H,...fe]),f(H=>[...fe,...H]),h(!1)}else U.action===google.picker.Action.CANCEL&&h(!1)}),v=new google.picker.DocsView(google.picker.ViewId.DOCS).setMode(google.picker.DocsViewMode.GRID).setIncludeFolders(!0).setMimeTypes(n);o.addView(v),o.enableFeature(google.picker.Feature.SUPPORT_DRIVES),o.enableFeature(google.picker.Feature.MULTISELECT_ENABLED),o.build().setVisible(!0)}catch(n){console.error("Create Picker Error:",n),h(!1),alert(`ÁÑ°Ê≥ïÂª∫Á´ã Picker„ÄÇ
Ë´ãÁ¢∫Ë™ç API Key Ë®≠ÂÆöÊ≠£Á¢∫„ÄÇ`)}},Oe=async t=>{if(t.target.files&&t.target.files.length>0){h(!0);const r=Array.from(t.target.files),n=[];try{for(const o of r){let v=o,U="";if(o.name.toLowerCase().endsWith(".heic")||o.type.includes("heic"))try{const he=await(await Ee(()=>import("./vendor--FBYh3JU.js").then(H=>H.h),[])).default({blob:o,toType:"image/jpeg",quality:.8}),fe=Array.isArray(he)?he[0]:he;v=new File([fe],o.name.replace(/\.heic$/i,".jpg"),{type:"image/jpeg"}),U=URL.createObjectURL(v)}catch{continue}else U=URL.createObjectURL(o);const le=v.type.startsWith("video/");n.push({id:crypto.randomUUID(),type:le?"video":"image",fileName:v.name,previewUrl:U,file:v,duration:le?5:d.photoDuration,transition:d.defaultTransition,overlays:[]})}c(o=>[...o,...n]),f(o=>[...n,...o])}catch(o){console.error(o)}finally{h(!1),I.current&&(I.current.value="")}}},Te=async()=>{if(i.length===0)return alert("Ê≤íÊúâÁ¥†ÊùêÂèØ‰ª•ÂÑ≤Â≠òÔºÅ");x(!0),m(0);try{await et(d,i,q,m)}catch(t){alert("ÂÑ≤Â≠òÂ§±ÊïóÔºö"+t)}x(!1)},_e=async t=>{var n;const r=(n=t.target.files)==null?void 0:n[0];if(r){x(!0),m(0);try{const o=await tt(r);A(o.settings),c(o.media),f([]),$(o.audioTracks),o.media.length>0&&P(o.media[0].id)}catch{alert("ËºâÂÖ•Â∞àÊ°àÂ§±Êïó")}x(!1),D.current&&(D.current.value="")}},Fe=()=>{confirm("Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÂÖßÂÆπ‰∏¶ÈáçÊñ∞ÈñãÂßãÂóéÔºü")&&(J(null),c([]),f([]),$([]),P(null),w(null),R(0),A({outputFileName:"ÊàëÁöÑÁ≤æÂΩ©ÂΩ±Áâá",aspectRatio:"16:9",photoDuration:3,transitionDuration:1,resolution:{width:1280,height:720},collageTitle:"ÊàëÁöÑÁ≤æÂΩ©ÂõûÊÜ∂",defaultTransition:G.RANDOM}))},De=()=>{const t=crypto.randomUUID(),r={id:t,type:"image",fileName:"Á©∫ÁôΩÊãºË≤º",previewUrl:"",duration:d.photoDuration,transition:G.FADE,overlays:[],gradientColors:ke[0]};c(n=>[r,...n]),P(t),R(0)},Ge=t=>{if(!j){i.some(n=>n.id===t.id)||c(n=>[...n,t]),P(t.id),f(n=>n.filter(o=>o.id!==t.id));return}const r={id:crypto.randomUUID(),type:"image",sourceUrl:t.previewUrl,x:d.resolution.width/2-200,y:d.resolution.height/2-150,width:400,height:300,scale:1,rotation:0,zIndex:50,crop:{t:0,b:0,l:0,r:0}};c(n=>n.map(v=>v.id===j?{...v,overlays:[...v.overlays,r]}:v).filter(v=>v.id===j||v.id!==t.id)),w(r.id),f(n=>n.filter(o=>o.id!==t.id))},$e=t=>{const r=i.find(n=>n.id===t);r&&r.fileName!=="Á©∫ÁôΩÊãºË≤º"&&f(n=>n.some(o=>o.id===r.id)?n:[r,...n]),c(n=>n.filter(o=>o.id!==t)),j===t&&P(null)},Se=t=>{if(t.target.files){const n=Array.from(t.target.files).map(o=>({file:o,url:URL.createObjectURL(o),name:o.name,duration:30}));$(o=>[...o,...n]),F(!1)}},ae=(t,r)=>{if(r.overlays){const n=i.find(o=>o.id===t);n&&n.overlays.filter(v=>{var U;return!((U=r.overlays)!=null&&U.find(O=>O.id===v.id))}).forEach(v=>{v.type==="image"&&v.sourceUrl&&f(U=>[{id:crypto.randomUUID(),type:"image",previewUrl:v.sourceUrl,fileName:"ÈÇÑÂéüÁöÑÁ¥†Êùê",duration:d.photoDuration,transition:G.FADE,overlays:[]},...U])})}c(n=>n.map(o=>o.id===t?{...o,...r}:o))},ze=t=>{let r=1280,n=720;t==="4:3"?(r=1024,n=768):t==="9:16"?(r=720,n=1280):t==="1:1"&&(r=1080,n=1080),A(o=>({...o,aspectRatio:t,resolution:{width:r,height:n}}))},Ce=(t,r)=>{if(!j)return;const n={id:crypto.randomUUID(),type:t,x:d.resolution.width/2-200,y:d.resolution.height/2-50,width:t==="text"?400:100,height:100,scale:1,rotation:0,zIndex:100,text:t==="text"?"Ë´ãËº∏ÂÖ•ÊñáÂ≠óÂÖßÂÆπ":void 0,emoji:t==="sticker"?r:void 0,fontFamily:Ue[0].value,fontSize:60,color:"#ffffff",backgroundColor:"#000000",backgroundOpacity:.7,backgroundPadding:20,backgroundRadius:10,strokeColor:"#000000",strokeWidth:0,animationType:t==="sticker"?"pulse":"none"};c(o=>o.map(v=>v.id===j?{...v,overlays:[...v.overlays,n]}:v)),w(n.id),t==="text"&&g("text")},He=()=>{if(T.current===null||_.current===null)return;const t=[...i],r=t.splice(T.current,1)[0];t.splice(_.current,0,r),T.current=null,_.current=null,c(t)},We=()=>{if(i.length===0)return alert("Ë´ãÂÖàÊñ∞Â¢ûÂ†¥ÊôØÁ¥†ÊùêÔºÅ");E(K.RENDERING),m(0)},Be=t=>{const r=document.createElement("a");r.href=t,r.download=`${d.outputFileName}.webm`,document.body.appendChild(r),r.click(),document.body.removeChild(r),E(K.FINISHED),setTimeout(()=>E(K.EDITING),2e3)},C=i.find(t=>t.id===j),ue=C==null?void 0:C.overlays.find(t=>t.id===M);return e.jsxs("div",{className:"fixed inset-0 bg-[#0b0e14] text-slate-100 flex flex-col overflow-hidden font-sans select-none touch-none",children:[e.jsxs("header",{className:"h-14 shrink-0 px-4 md:px-6 flex justify-between items-center bg-[#161b22] border-b border-slate-800/50 z-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center font-black italic text-sm",children:"E"}),e.jsx("h1",{className:"text-lg font-black tracking-tighter italic text-slate-200 uppercase hidden md:block",children:"Easymaker 123"})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx("button",{onClick:Fe,className:"px-3 py-1.5 md:px-4 bg-red-900/20 hover:bg-red-900/40 text-red-400 border border-red-900/50 rounded-full text-[10px] font-black uppercase tracking-widest transition-all active:scale-95",children:"ÈáçÊñ∞ÈñãÂßã"}),e.jsx("button",{onClick:()=>{var t;return(t=D.current)==null?void 0:t.click()},className:"px-3 py-1.5 md:px-4 bg-slate-800 hover:bg-slate-700 rounded-full text-[10px] font-black uppercase tracking-widest border border-slate-700 transition-all active:scale-95",children:"ÈñãÂïü"}),e.jsx("input",{type:"file",ref:D,accept:".ezp",className:"hidden",onChange:_e}),e.jsx("button",{onClick:Te,className:"px-3 py-1.5 md:px-4 bg-slate-800 hover:bg-slate-700 rounded-full text-[10px] font-black uppercase tracking-widest border border-slate-700 transition-all active:scale-95",children:"ÂÑ≤Â≠ò"}),e.jsx("button",{onClick:We,disabled:l===K.RENDERING,className:`bg-indigo-600 hover:bg-indigo-500 px-4 md:px-6 py-1.5 rounded-full text-xs font-black shadow-lg shadow-indigo-500/20 transition-all active:scale-95 ${l===K.RENDERING?"opacity-50 cursor-not-allowed":""}`,children:l===K.RENDERING?`${a}%`:"ÂåØÂá∫"})]})]}),e.jsxs("main",{className:"flex-1 flex flex-col md:flex-row overflow-hidden min-h-0 relative",children:[e.jsxs("aside",{className:"order-last md:order-first w-full md:w-[340px] h-[35vh] md:h-full shrink-0 bg-[#161b22] flex flex-col border-t md:border-r border-slate-800/50 overflow-hidden relative z-20",children:[e.jsx("div",{className:"flex border-b border-slate-800/30 shrink-0 md:flex-row order-last md:order-first",children:[{id:"media",icon:"üñºÔ∏è",label:"Â™íÈ´î"},{id:"audio",icon:"üéµ",label:"Èü≥Ê®Ç"},{id:"sticker",icon:"üòä",label:"Ë≤ºÂúñ"},{id:"text",icon:"üìù",label:"ÊñáÂ≠ó"},{id:"settings",icon:"‚öôÔ∏è",label:"Ë®≠ÂÆö"}].map(t=>e.jsxs("button",{onClick:()=>g(t.id),className:`flex-1 flex flex-col items-center py-2 md:py-3 gap-1 transition-all ${N===t.id?"bg-indigo-600/10 text-indigo-400 border-t-2 md:border-t-0 md:border-b-2 border-indigo-500":"text-slate-500 hover:text-slate-300"}`,children:[e.jsx("span",{className:t.id==="text"?"text-sm font-black":"text-lg",children:t.icon}),e.jsx("span",{className:"text-[9px] md:text-[10px] font-bold tracking-widest",children:t.label})]},t.id))}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-5 scrollbar-thin bg-[#161b22]",children:[N==="media"&&e.jsxs("div",{className:"space-y-4 md:space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 md:gap-3",children:[e.jsxs("button",{onClick:()=>{var t;return(t=I.current)==null?void 0:t.click()},className:"col-span-2 py-3 md:py-4 bg-slate-800/40 border border-slate-700/50 rounded-2xl flex items-center justify-center gap-2 hover:bg-slate-700/60 transition-all active:scale-95 group",children:[e.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:"üì§"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"ÂåØÂÖ•Êú¨Âú∞"})]}),e.jsxs("button",{onClick:()=>ge("drive"),className:"py-2 md:py-3 bg-blue-600/10 border border-blue-500/20 rounded-2xl flex flex-col items-center justify-center gap-1 hover:bg-blue-600/20 transition-all active:scale-95",children:[e.jsx("span",{className:"text-xl",children:"üìÅ"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-blue-400",children:"Drive"})]}),e.jsxs("button",{onClick:()=>ge("photos"),className:"py-2 md:py-3 bg-emerald-600/10 border border-emerald-500/20 rounded-2xl flex flex-col items-center justify-center gap-1 hover:bg-emerald-600/20 transition-all active:scale-95",children:[e.jsx("span",{className:"text-xl",children:"üåà"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-400",children:"Photos"})]}),e.jsxs("button",{onClick:De,className:"col-span-2 py-2 md:py-3 bg-indigo-600/10 border border-indigo-500/20 rounded-2xl flex items-center justify-center gap-2 hover:bg-indigo-600/20 transition-all active:scale-95",children:[e.jsx("span",{className:"text-xl",children:"üß©"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Êñ∞Â¢ûÁ©∫ÁôΩÊãºË≤º"})]})]}),e.jsx("input",{type:"file",ref:I,multiple:!0,accept:"image/*,video/*,.heic,.HEIC,.mov,.mp4,.webm,.mkv,.avi,.gif,.webp",onChange:Oe,className:"hidden"}),e.jsxs("div",{className:"space-y-2 md:space-y-3 mt-4",children:[e.jsxs("h3",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:["ÂæÖ‰ΩøÁî® (",u.length,")"]}),u.length>0?e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-2 gap-2",children:u.map(t=>e.jsx("div",{className:"aspect-video bg-[#0b0e14] rounded-xl overflow-hidden border border-slate-800 group relative cursor-pointer",onClick:()=>Ge(t),children:e.jsx("img",{src:t.previewUrl,className:"w-full h-full object-cover transition-transform group-hover:scale-110",alt:""})},t.id))}):e.jsx("div",{className:"py-8 border border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center opacity-40 text-center",children:e.jsx("p",{className:"text-[9px] font-bold uppercase",children:"ÁÑ°ÂèØÁî®Á¥†Êùê"})})]})]}),N==="audio"&&e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-left-4 duration-300",children:[e.jsxs("button",{onClick:()=>{var t;return(t=B.current)==null?void 0:t.click()},className:"w-full py-4 bg-slate-800/40 border border-slate-700/50 rounded-2xl flex items-center justify-center gap-3 hover:bg-slate-700 transition-colors",children:[e.jsx("span",{className:"text-xl",children:"üìÅ"}),e.jsx("span",{className:"text-xs font-black",children:"Êú¨Âú∞Èü≥Ê®ÇÂåØÂÖ•"})]}),e.jsxs("button",{onClick:()=>F(!0),className:"w-full py-4 bg-red-600/10 border border-red-500/20 rounded-2xl flex items-center justify-center gap-3 hover:bg-red-600/20 text-red-500 transition-colors",children:[e.jsx("span",{className:"text-xl",children:"üé¨"}),e.jsx("span",{className:"text-xs font-black",children:"YouTube ‰∏ãËºâ"})]}),e.jsx("input",{type:"file",ref:B,accept:"audio/*",className:"hidden",multiple:!0,onChange:Se}),q.length>0&&e.jsx("div",{className:"space-y-2 pt-2",children:q.map(t=>e.jsxs("div",{className:"p-3 bg-[#0b0e14] rounded-xl border border-slate-800 flex items-center gap-3 group",children:[e.jsx("span",{className:"text-lg",children:"üéµ"}),e.jsx("span",{className:"text-[10px] font-bold truncate flex-1",children:t.name}),e.jsx("button",{onClick:()=>$(r=>r.filter(n=>n.url!==t.url)),className:"text-red-500 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity",children:"‚úï"})]},t.url))})]}),N==="sticker"&&e.jsx("div",{className:"grid grid-cols-4 gap-2 animate-in fade-in duration-300",children:Je.map(t=>e.jsx("button",{onClick:()=>Ce("sticker",t),className:"aspect-square bg-slate-800/40 rounded-xl hover:bg-slate-700 text-2xl flex items-center justify-center transition-all active:scale-90",children:t},t))}),N==="text"&&e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-left-4 duration-300 h-full flex flex-col",children:[e.jsxs("button",{onClick:()=>Ce("text"),className:"shrink-0 w-full py-3 bg-indigo-600 text-white rounded-2xl text-xs font-black shadow-lg shadow-indigo-500/20 active:scale-95 transition-all flex items-center justify-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:"Ôºã"})," Êñ∞Â¢ûÊñáÂ≠ó"]}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-1 scrollbar-thin",children:ue&&ue.type==="text"?e.jsxs("div",{className:"space-y-4 pt-2 border-t border-slate-800/50",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest",children:"Á∑®ËºØ‰∏≠"}),e.jsx("button",{onClick:()=>{ae(C.id,{overlays:C.overlays.filter(t=>t.id!==M)}),w(null)},className:"text-red-500 text-[10px] font-black hover:underline",children:"Âà™Èô§"})]}),e.jsx("div",{className:"space-y-1",children:e.jsx("textarea",{value:ue.text,onChange:t=>ae(C.id,{overlays:C.overlays.map(r=>r.id===M?{...r,text:t.target.value}:r)}),className:"w-full bg-[#0b0e14] border border-slate-700 p-2 rounded-xl text-xs font-medium outline-none focus:border-indigo-500",rows:2})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("select",{value:ue.fontFamily,onChange:t=>ae(C.id,{overlays:C.overlays.map(r=>r.id===M?{...r,fontFamily:t.target.value}:r)}),className:"w-full bg-[#0b0e14] border border-slate-700 p-2 rounded-xl text-[10px] font-bold focus:border-indigo-500 outline-none",children:Ue.map(t=>e.jsx("option",{value:t.value,children:t.name},t.value))}),e.jsx("input",{type:"color",value:ue.color,onChange:t=>ae(C.id,{overlays:C.overlays.map(r=>r.id===M?{...r,color:t.target.value}:r)}),className:"w-full h-10 rounded-lg bg-[#0b0e14] border border-slate-700 p-1"})]})]}):e.jsx("div",{className:"flex flex-col items-center justify-center py-10 opacity-40",children:e.jsx("p",{className:"text-[10px] font-black uppercase",children:"Ë´ãÈÅ∏ÊìáÊñáÂ≠ó"})})})]}),N==="settings"&&e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-left-4 duration-300",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Ê™îÂêç"}),e.jsx("input",{type:"text",value:d.outputFileName,onChange:t=>A({...d,outputFileName:t.target.value}),className:"w-full bg-[#0b0e14] border border-slate-700 p-2 rounded-xl text-xs font-bold focus:border-indigo-500 outline-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"ÊØî‰æã"}),e.jsx("div",{className:"grid grid-cols-4 gap-1",children:["16:9","4:3","9:16","1:1"].map(t=>e.jsx("button",{onClick:()=>ze(t),className:`py-1.5 px-1 rounded-lg text-[9px] font-black border transition-all ${d.aspectRatio===t?"bg-indigo-600 border-indigo-500 text-white":"bg-slate-800/40 border-slate-700 text-slate-400"}`,children:t},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"ÁÖßÁâáÁßíÊï∏"}),e.jsxs("span",{className:"text-xs font-black text-indigo-400",children:[d.photoDuration,"s"]})]}),e.jsx("input",{type:"range",min:"1",max:"10",step:"0.5",value:d.photoDuration,onChange:t=>A({...d,photoDuration:parseFloat(t.target.value)}),className:"w-full h-1 bg-slate-700 rounded-full appearance-none accent-indigo-500"})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-800/50 space-y-2",children:[e.jsx("h3",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Ê≥ïÂæãË≥áË®ä"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("a",{href:"https://alice55505-source.github.io/-123/privacy.html",target:"_blank",rel:"noreferrer",className:"text-xs font-bold text-slate-400 hover:text-indigo-400 transition-colors flex items-center gap-2 px-2 py-2 rounded-lg hover:bg-slate-800/50",children:[e.jsx("span",{children:"üõ°Ô∏è"})," Èö±ÁßÅÊ¨äÊîøÁ≠ñ"]}),e.jsxs("a",{href:"https://alice55505-source.github.io/-123/terms.html",target:"_blank",rel:"noreferrer",className:"text-xs font-bold text-slate-400 hover:text-indigo-400 transition-colors flex items-center gap-2 px-2 py-2 rounded-lg hover:bg-slate-800/50",children:[e.jsx("span",{children:"‚öñÔ∏è"})," ÊúçÂãôÊ¢ùÊ¨æ"]})]})]})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-[#0b0e14] h-full overflow-hidden relative order-first md:order-last",children:[e.jsxs("div",{className:"flex-1 p-4 md:p-8 flex items-center justify-center relative min-h-0 bg-[#0b0e14]",children:[e.jsxs("div",{className:"absolute top-2 left-4 md:top-6 md:left-8 z-10 flex flex-col gap-2 transition-opacity duration-500 opacity-100 pointer-events-none",children:[e.jsxs("div",{className:"px-3 py-1 bg-[#161b22]/90 backdrop-blur-md border border-slate-800/50 rounded-full flex items-center gap-2 shadow-2xl w-fit pointer-events-auto",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-[9px] md:text-[10px] font-black text-slate-300 uppercase tracking-[0.2em]",children:[L+1," / ",i.length]})]}),C&&C.type==="image"&&e.jsx("button",{onClick:()=>s(!b),className:`px-3 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest transition-all shadow-xl pointer-events-auto w-fit ${b?"bg-red-500 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:b?"‚èπÔ∏è ÈÄÄÂá∫Ë£ÅÂâ™":"‚úÇÔ∏è Ë£ÅÂâ™"})]}),e.jsxs("div",{className:"flex items-center gap-6 h-full w-full justify-center",children:[e.jsx("div",{className:"w-full h-full max-w-[960px] aspect-video bg-black rounded-xl md:rounded-[3rem] overflow-hidden transition-all duration-700 relative group/canvas shadow-[0_0_50px_rgba(0,0,0,0.5)] border-[4px] md:border-[12px] border-[#161b22]",children:l===K.RENDERING?e.jsx(p.Suspense,{fallback:e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 font-bold",children:"ËºâÂÖ•È†êË¶ΩÂÖÉ‰ª∂‰∏≠..."}),children:e.jsx(st,{mediaList:i,audio:q,settings:d,appState:l,onRenderingComplete:Be,onProgress:m,setSelectedOverlayId:w})}):C?e.jsx(qe,{item:C,settings:d,selectedOverlayId:M,setSelectedOverlayId:w,isCropMode:b,onUpdate:t=>ae(C.id,t)}):e.jsx("div",{className:"w-full h-full flex flex-col items-center justify-center gap-6 bg-gradient-to-br from-[#0b0e14] to-slate-900",children:e.jsx("span",{className:"text-4xl opacity-20",children:"üé®"})})}),e.jsx("div",{className:"hidden md:block",children:C&&C.fileName==="Á©∫ÁôΩÊãºË≤º"&&e.jsxs("div",{className:"w-[180px] shrink-0 bg-[#161b22]/90 backdrop-blur-md rounded-[2rem] p-4 flex flex-col gap-4 border border-slate-800/50 shadow-2xl h-[400px] animate-in slide-in-from-right-8 duration-500",children:[e.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest text-center py-2 border-b border-slate-700/50",children:"üé® Ëé´Ëò≠Ëø™ËÉåÊôØ"}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-1 scrollbar-thin",children:ke.map((t,r)=>{var n;return e.jsx("button",{onClick:()=>ae(C.id,{gradientColors:t}),className:`w-full aspect-video rounded-xl transition-all hover:scale-105 active:scale-95 border-2 relative overflow-hidden group ${((n=C.gradientColors)==null?void 0:n.name)===t.name?"border-white shadow-lg":"border-transparent hover:border-slate-500"}`,style:{background:`linear-gradient(135deg, ${t.start}, ${t.end})`}},r)})})]})})]})]}),e.jsxs("div",{className:"h-28 md:h-48 shrink-0 bg-[#161b22] border-t border-slate-800/50 flex flex-col px-4 md:px-8 py-3 md:py-5 z-20 transition-all duration-500",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 md:mb-4 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-[9px] md:text-[10px] text-slate-300 font-black tracking-widest uppercase",children:"ÊôÇÈñìËª∏"}),e.jsx("div",{className:"h-3 w-[1px] bg-slate-800"}),e.jsxs("span",{className:"text-[9px] md:text-[10px] text-slate-500 font-bold tracking-widest uppercase",children:[i.reduce((t,r)=>t+(r.type==="video"?r.duration||5:d.photoDuration),0).toFixed(1),"s"]})]}),C&&C.fileName==="Á©∫ÁôΩÊãºË≤º"&&e.jsxs("div",{className:"flex items-center gap-2 md:hidden overflow-x-auto scrollbar-thin max-w-[60%] pb-1",children:[e.jsx("span",{className:"text-[8px] text-slate-500 font-black shrink-0",children:"ËÉåÊôØ"}),ke.map((t,r)=>{var n;return e.jsx("button",{onClick:()=>ae(C.id,{gradientColors:t}),className:`w-6 h-6 rounded-full shrink-0 border-2 transition-transform ${((n=C.gradientColors)==null?void 0:n.name)===t.name?"border-white scale-110 shadow-md":"border-slate-700/50"}`,style:{background:`linear-gradient(135deg, ${t.start}, ${t.end})`},title:t.name},r)})]})]}),e.jsxs("div",{className:"flex-1 flex gap-2 md:gap-4 overflow-x-auto pb-2 scrollbar-thin min-h-0 items-center",children:[i.map((t,r)=>{var n;return e.jsxs(Ie.Fragment,{children:[e.jsxs("div",{draggable:!0,onDragStart:()=>T.current=r,onDragEnter:()=>_.current=r,onDragEnd:He,onDragOver:o=>o.preventDefault(),onClick:()=>{P(t.id),R(r)},className:`relative shrink-0 h-full aspect-video rounded-lg md:rounded-2xl border-2 md:border-4 transition-all overflow-hidden cursor-pointer md:cursor-move group/thumb ${j===t.id?"border-indigo-600 ring-2 ring-indigo-500/20 z-10 scale-105 shadow-xl":"border-slate-800 opacity-60 hover:opacity-100 hover:border-slate-700"}`,style:t.fileName==="Á©∫ÁôΩÊãºË≤º"&&t.gradientColors?{background:`linear-gradient(135deg, ${t.gradientColors.start}, ${t.gradientColors.end})`}:{},children:[t.previewUrl?e.jsx("img",{src:t.previewUrl,className:"w-full h-full object-cover pointer-events-none",alt:""}):!t.gradientColors&&e.jsx("div",{className:"w-full h-full bg-slate-900 flex items-center justify-center text-xl pointer-events-none",children:"üß©"}),e.jsx("div",{className:"absolute bottom-1 left-1 px-1.5 py-0.5 bg-black/70 backdrop-blur-md rounded text-[8px] font-black text-white",children:r+1}),e.jsx("button",{onClick:o=>{o.stopPropagation(),$e(t.id)},className:"absolute top-1 right-1 bg-red-600/90 text-white w-5 h-5 md:w-7 md:h-7 rounded-full text-[8px] md:text-[10px] flex items-center justify-center shadow-lg opacity-100 md:opacity-0 group-hover/thumb:opacity-100 transition-opacity",children:"‚úï"})]}),r<i.length-1&&e.jsx("div",{className:"shrink-0 flex items-center justify-center relative w-4 md:w-8 z-10",children:e.jsxs("button",{onClick:o=>{o.stopPropagation();const v=Object.values(G),U=v.indexOf(t.transition||G.RANDOM),O=v[(U+1)%v.length];ae(t.id,{transition:O})},className:"w-5 h-5 md:w-6 md:h-6 rounded-full bg-slate-800 border border-slate-600 hover:border-indigo-500 hover:bg-indigo-600 flex items-center justify-center transition-all z-20 shadow-lg active:scale-90 group/trans",title:`ÁõÆÂâçËΩâÂ†¥: ${ot[t.transition||G.RANDOM]}`,children:[e.jsx("span",{className:"text-[8px] text-slate-400 hover:text-white group-hover/trans:hidden",children:"‚ö°"}),e.jsx("span",{className:"text-[7px] text-white hidden group-hover/trans:block font-black uppercase",children:t.transition===G.RANDOM?"R":(n=t.transition)==null?void 0:n.charAt(0)})]})})]},t.id)}),e.jsx("button",{onClick:De,className:"shrink-0 h-full aspect-video bg-[#0b0e14] border-2 border-dashed border-slate-800 rounded-lg md:rounded-3xl flex flex-col items-center justify-center gap-1 text-slate-600 hover:text-indigo-400 hover:border-indigo-600 transition-all hover:bg-slate-800/10 group active:scale-95",children:e.jsx("span",{className:"text-xl md:text-3xl group-hover:scale-110 transition-transform",children:"Ôºã"})})]})]})]})]}),te&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 flex items-center justify-center p-4 md:p-12 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-[#161b22] w-full max-w-5xl h-[85vh] rounded-[2rem] md:rounded-[4rem] flex flex-col overflow-hidden border border-slate-800 shadow-[0_0_150px_rgba(0,0,0,0.8)]",children:[e.jsxs("div",{className:"p-4 md:p-8 flex justify-between items-center bg-[#0b0e14]/50 border-b border-slate-800/30",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx("span",{className:"text-2xl md:text-3xl",children:"üì•"}),e.jsx("h2",{className:"font-black text-xs md:text-sm uppercase tracking-[0.3em]",children:"YouTube ÂåØÂÖ•"})]}),e.jsx("button",{onClick:()=>F(!1),className:"w-8 h-8 md:w-12 md:h-12 rounded-full hover:bg-slate-800 flex items-center justify-center text-slate-500 hover:text-white transition-all active:scale-90",children:"‚úï"})]}),e.jsx("iframe",{src:"https://ezconv.cc/",className:"flex-1 bg-white"}),e.jsxs("div",{className:"p-6 md:p-10 bg-[#0b0e14] flex flex-col items-center gap-4 md:gap-6",children:[e.jsx("button",{onClick:()=>{var t;return(t=Y.current)==null?void 0:t.click()},className:"px-8 md:px-16 py-3 md:py-4 bg-red-600 hover:bg-red-500 text-white font-black rounded-full text-xs transition-all active:scale-95 shadow-2xl shadow-red-600/30 uppercase tracking-[0.2em]",children:"ÈÅ∏Âèñ‰∏ãËºâÊ™îÊ°à"}),e.jsx("input",{type:"file",accept:"audio/*",ref:Y,onChange:Se,className:"hidden"})]})]})}),oe&&e.jsx("div",{className:"fixed inset-0 z-[150] bg-black/95 flex items-center justify-center p-4 md:p-8 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-[#161b22] w-full max-w-6xl h-[90vh] rounded-[2rem] flex flex-col overflow-hidden border border-slate-800 shadow-[0_0_150px_rgba(0,0,0,0.8)]",children:[e.jsxs("div",{className:"p-6 flex justify-between items-center bg-[#0b0e14]/80 border-b border-slate-800/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl",children:"üåà"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"font-black text-lg uppercase tracking-widest text-white",children:"Google Photos"}),e.jsx("span",{className:"text-[10px] text-slate-400",children:"ÈªûÊìäÁÖßÁâáÂç≥ÂèØÂåØÂÖ•"})]})]}),e.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-full text-xs font-bold transition-all",children:"ÈóúÈñâ"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 scrollbar-thin",children:[ie&&W.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center gap-4 text-slate-500",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest",children:"ËÆÄÂèñÁõ∏Á∞ø‰∏≠..."})]}):X?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center gap-6 text-slate-400 p-8 text-center",children:[e.jsx("span",{className:"text-4xl",children:"‚ö†Ô∏è"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-black text-white",children:"ËÆÄÂèñÁõ∏Á∞øÂ§±Êïó"}),e.jsx("p",{className:"text-xs max-w-md mx-auto",children:X==="scope_error"?"Ê¨äÈôê‰∏çË∂≥ÔºöÊÇ®ÂèØËÉΩÂú® Google ÁôªÂÖ•ÊôÇÊú™ÂãæÈÅ∏„ÄåGoogle Áõ∏Á∞ø„ÄçÂ≠òÂèñÊ¨ä„ÄÇ":X==="api_error"?"API Êú™ÂïüÁî®ÔºöË´ãÁ¢∫Ë™çÊÇ®ÁöÑ Google Cloud Â∞àÊ°àÂ∑≤ÂïüÁî®„ÄåPhotos Library API„Äç„ÄÇ":X})]}),X==="scope_error"&&e.jsx("button",{onClick:ee,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full text-xs font-black uppercase tracking-widest shadow-lg shadow-indigo-600/30 active:scale-95 transition-all",children:"ÈáçÊñ∞ÊéàÊ¨ä (Ë´ãÂãæÈÅ∏ÊâÄÊúâÊ¨äÈôê)"}),X==="api_error"&&e.jsx("a",{href:"https://console.cloud.google.com/apis/library/photoslibrary.googleapis.com",target:"_blank",rel:"noreferrer",className:"px-8 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-full text-xs font-black uppercase tracking-widest transition-all",children:"ÂâçÂæÄ Google Cloud Console ÂïüÁî®"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:W.map(t=>{var r;return e.jsxs("button",{onClick:()=>we(t),className:"aspect-square relative group overflow-hidden rounded-xl border border-slate-800 hover:border-indigo-500 hover:scale-105 transition-all bg-black",children:[e.jsx("img",{src:`${t.baseUrl}=w400-h400-c`,className:"w-full h-full object-cover",alt:"photo",loading:"lazy"}),((r=t.mediaMetadata)==null?void 0:r.video)&&e.jsx("span",{className:"absolute top-2 right-2 text-xs",children:"üé•"}),e.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx("span",{className:"font-bold text-white drop-shadow-md",children:"Ôºã ÂåØÂÖ•"})})]},t.id)})}),!ie&&!X&&se&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx("button",{onClick:()=>re(S,se),className:"px-8 py-3 bg-slate-800 hover:bg-slate-700 rounded-full text-xs font-black uppercase tracking-widest text-slate-300 hover:text-white transition-all",children:"ËºâÂÖ•Êõ¥Â§ö"})})]})]})}),(l===K.RENDERING||k||y)&&e.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#0b0e14] flex flex-col items-center justify-center gap-8 p-12",children:[e.jsx("div",{className:"w-24 h-24 md:w-32 md:h-32 bg-indigo-600 rounded-[2.5rem] flex items-center justify-center text-4xl md:text-5xl shadow-2xl shadow-indigo-600/40 animate-pulse",children:y?"‚òÅÔ∏è":k?"üìÅ":"‚öôÔ∏è"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-lg md:text-2xl font-black uppercase tracking-[0.4em]",children:y?"ËôïÁêÜ‰∏≠":k?"Â∞àÊ°àËôïÁêÜ‰∏≠":"ÂåØÂá∫‰∏≠"}),!y&&e.jsxs("span",{className:"text-indigo-400 font-black text-xl tabular-nums",children:[a,"%"]}),y&&e.jsx("button",{onClick:()=>h(!1),className:"mt-8 px-6 py-2 bg-slate-800 border border-slate-700 rounded-full text-xs font-bold text-slate-400 hover:text-white hover:bg-slate-700 transition-all",children:"ÂèñÊ∂à / ÈóúÈñâ"})]})]}),l===K.FINISHED&&e.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#0b0e14] flex flex-col items-center justify-center gap-6",children:[e.jsx("div",{className:"w-24 h-24 bg-emerald-500 rounded-full flex items-center justify-center text-4xl shadow-2xl shadow-emerald-500/30",children:"‚ú®"}),e.jsx("h2",{className:"text-xl md:text-2xl font-black uppercase tracking-[0.3em]",children:"ÂÆåÊàêÔºÅ"})]})]})},Ae=document.getElementById("root");if(!Ae)throw new Error("Could not find root element to mount to");const ct=Ye.createRoot(Ae);ct.render(e.jsx(Ie.StrictMode,{children:e.jsx(it,{})}));export{K as A,G as T};
