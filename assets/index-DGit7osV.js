const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VideoPreview-CUwyc-D6.js","assets/vendor--FBYh3JU.js"])))=>i.map(i=>d[i]);
import{r as m,j as e,R as ke,c as Ae}from"./vendor--FBYh3JU.js";(function(){const D=document.createElement("link").relList;if(D&&D.supports&&D.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))h(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&h(d)}).observe(document,{childList:!0,subtree:!0});function w(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function h(i){if(i.ep)return;i.ep=!0;const c=w(i);fetch(i.href,c)}})();const Te="modulepreload",_e=function(l){return"/"+l},De={},Ne=function(D,w,h){let i=Promise.resolve();if(w&&w.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),u=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));i=Promise.allSettled(w.map(v=>{if(v=_e(v),v in De)return;De[v]=!0;const U=v.endsWith(".css"),E=U?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${E}`))return;const g=document.createElement("link");if(g.rel=U?"stylesheet":Te,U||(g.as="script"),g.crossOrigin="",g.href=v,u&&g.setAttribute("nonce",u),document.head.appendChild(g),U)return new Promise((L,C)=>{g.addEventListener("load",L),g.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${v}`)))})}))}function c(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return i.then(d=>{for(const u of d||[])u.status==="rejected"&&c(u.reason);return D().catch(c)})};var G=(l=>(l.FADE="FADE",l.SLIDE_UP="SLIDE_UP",l.SLIDE_DOWN="SLIDE_DOWN",l.SLIDE_LEFT="SLIDE_LEFT",l.SLIDE_RIGHT="SLIDE_RIGHT",l.ZOOM_IN="ZOOM_IN",l.RANDOM="RANDOM",l))(G||{}),q=(l=>(l.IDLE="IDLE",l.COLLAGE="COLLAGE",l.EDITING="EDITING",l.RENDERING="RENDERING",l.FINISHED="FINISHED",l))(q||{});const Fe=({item:l,settings:D,selectedOverlayId:w,setSelectedOverlayId:h,onUpdate:i,isCropMode:c})=>{const d=m.useRef(null),u=m.useRef({}),v=m.useRef(""),[U,E]=m.useState(0),[g,L]=m.useState("NONE"),[C,J]=m.useState(null),[$,re]=m.useState({x:0,y:0}),[T,Z]=m.useState(null),z=D.resolution.width,B=D.resolution.height;m.useEffect(()=>{if(l.file||!d.current)return;const x=setInterval(()=>{if(g!=="NONE")return;const r=d.current.toDataURL("image/jpeg",.3);r.length!==v.current.length&&(v.current=r,i({previewUrl:r}))},2e3);return()=>clearInterval(x)},[l.id,l.file,i,g]),m.useEffect(()=>{const x=[];if(l.file&&l.previewUrl&&!u.current[l.previewUrl]&&x.push({key:l.previewUrl,url:l.previewUrl,type:l.type}),l.overlays.forEach(a=>{a.type==="image"&&a.sourceUrl&&!u.current[a.sourceUrl]&&x.push({key:a.sourceUrl,url:a.sourceUrl,type:"image"})}),x.length===0)return;let r=0;x.forEach(a=>{if(a.type==="video"){const f=document.createElement("video");f.src=a.url,f.muted=!0,f.onloadeddata=()=>{u.current[a.key]=f,r++,r===x.length&&E(N=>N+1)},f.onerror=()=>{r++,r===x.length&&E(N=>N+1)},f.load()}else{const f=new Image;f.src=a.url,f.onload=()=>{u.current[a.key]=f,r++,r===x.length&&E(N=>N+1)},f.onerror=()=>{r++,r===x.length&&E(N=>N+1)}}})},[l.id,l.overlays.length,l.type,l.file]);const ae=x=>{var f,N;return`${((f=x.fontFamily)==null?void 0:f.includes("KaiTi"))||((N=x.fontFamily)==null?void 0:N.includes("Noto"))?"bold":"normal"} ${x.fontSize}px ${x.fontFamily}`},Q=(x,r)=>{let a=r.width,f=r.height;if(r.type==="text"){x.font=ae(r);const N=x.measureText(r.text||""),p=r.backgroundPadding||0;a=N.width+p*2,f=(r.fontSize||60)+p*2}return{w:a,h:f}},oe=m.useCallback(()=>{const x=d.current;if(!x)return;const r=x.getContext("2d");if(r){if(r.clearRect(0,0,z,B),l.file){r.fillStyle="#0b0e14",r.fillRect(0,0,z,B);const a=u.current[l.previewUrl];if(a){const f=a instanceof HTMLVideoElement?a.videoWidth:a.width,N=a instanceof HTMLVideoElement?a.videoHeight:a.height;if(f>0&&N>0){const p=Math.max(z/f,B/N),y=f*p,k=N*p;r.drawImage(a,(z-y)/2,(B-k)/2,y,k)}}}else if(l.gradientColors){const a=r.createLinearGradient(0,0,z,B);a.addColorStop(0,l.gradientColors.start),a.addColorStop(1,l.gradientColors.end),r.fillStyle=a,r.fillRect(0,0,z,B)}else r.fillStyle="#1e293b",r.fillRect(0,0,z,B);[...l.overlays].sort((a,f)=>a.zIndex-f.zIndex).forEach(a=>{r.save();const{w:f,h:N}=Q(r,a),p=f*a.scale,y=N*a.scale;if(r.translate(a.x+p/2,a.y+y/2),r.rotate(a.rotation),r.translate(-p/2,-y/2),a.type==="image"){const k=a.sourceUrl?u.current[a.sourceUrl]:null;if(k){const j=a.crop||{t:0,b:0,l:0,r:0},O=k.width*j.l,H=k.height*j.t,Y=k.width*(1-j.l-j.r),R=k.height*(1-j.t-j.b);r.drawImage(k,O,H,Y,R,0,0,p,y)}}else if(a.type==="text"){const k=a.backgroundPadding||0;a.backgroundColor&&(r.fillStyle=a.backgroundColor,r.globalAlpha=a.backgroundOpacity||.7,r.beginPath(),r.roundRect(0,0,p,y,a.backgroundRadius||10),r.fill()),r.globalAlpha=1,r.save(),r.scale(a.scale,a.scale),r.font=ae(a),r.textBaseline="top",a.strokeColor&&(a.strokeWidth||0)>0&&(r.strokeStyle=a.strokeColor,r.lineWidth=(a.strokeWidth||0)*2,r.lineJoin="round",r.strokeText(a.text||"",k,k)),r.fillStyle=a.color||"#fff",r.fillText(a.text||"",k,k),r.restore()}else a.type==="sticker"&&(r.font=`${y}px sans-serif`,r.textAlign="center",r.textBaseline="middle",r.fillText(a.emoji||"",p/2,y/2));w===a.id&&(r.strokeStyle=c?"#ef4444":"#6366f1",r.lineWidth=4,r.setLineDash(c?[]:[10,5]),r.strokeRect(-2,-2,p+4,y+4),r.setLineDash([]),c&&a.type==="image"?(r.fillStyle="#ef4444",[[0,0,"tl"],[p,0,"tr"],[p,y,"br"],[0,y,"bl"]].forEach(([k,j])=>{r.beginPath(),r.arc(k,j,10,0,Math.PI*2),r.fill()})):c||(r.fillStyle="#6366f1",r.beginPath(),r.arc(p,y,12,0,Math.PI*2),r.fill(),r.fillStyle="#10b981",r.beginPath(),r.arc(p/2,-40,12,0,Math.PI*2),r.fill())),r.restore()})}},[l,w,z,B,U,c]);m.useEffect(()=>{oe()},[oe]);const ne=x=>{const r=d.current.getBoundingClientRect();let a=0,f=0;return"touches"in x?(a=x.touches[0].clientX,f=x.touches[0].clientY):(a=x.clientX,f=x.clientY),{x:(a-r.left)*(z/r.width),y:(f-r.top)*(B/r.height)}},_=x=>{const{x:r,y:a}=ne(x),f=d.current.getContext("2d");if(w){const p=l.overlays.find(H=>H.id===w),{w:y,h:k}=Q(f,p),j=y*p.scale,O=k*p.scale;if(c&&p.type==="image"){const H=p.x+j/2,Y=p.y+O/2,R=-p.rotation,M=r-H,V=a-Y,W=M*Math.cos(R)-V*Math.sin(R)+j/2,P=M*Math.sin(R)+V*Math.cos(R)+O/2,le=[{x:0,y:0,id:"tl"},{x:j,y:0,id:"tr"},{x:j,y:O,id:"br"},{x:0,y:O,id:"bl"}];for(const te of le)if(Math.hypot(W-te.x,P-te.y)<40){L("CROP"),J(te.id),re({x:r,y:a}),Z({...p});return}}else if(!c){const H=p.x+j/2,Y=p.y+O/2,R=-p.rotation,M=r-H,V=a-Y,W=M*Math.cos(R)-V*Math.sin(R)+j/2,P=M*Math.sin(R)+V*Math.cos(R)+O/2;if(Math.hypot(W-j,P-O)<40){L("SCALE"),re({x:r,y:a}),Z({...p});return}if(Math.hypot(W-j/2,P+40)<40){L("ROTATE"),re({x:r,y:a}),Z({...p});return}}}const N=[...l.overlays].reverse().find(p=>{const{w:y,h:k}=Q(f,p),j=y*p.scale,O=k*p.scale,H=p.x+j/2,Y=p.y+O/2,R=-p.rotation,M=r-H,V=a-Y,W=M*Math.cos(R)-V*Math.sin(R)+j/2,P=M*Math.sin(R)+V*Math.cos(R)+O/2;return W>=0&&W<=j&&P>=0&&P<=O});N?(h(N.id),L("MOVE"),re({x:r,y:a}),Z({...N})):h(null)},S=x=>{if(g==="NONE"||!w||!T)return;"touches"in x&&x.cancelable&&x.preventDefault();const{x:r,y:a}=ne(x),f=r-$.x,N=a-$.y,p=l.overlays.map(y=>{if(y.id!==w)return y;if(g==="MOVE")return{...y,x:T.x+f,y:T.y+N};if(g==="SCALE"){const k=(f+N)/400;return{...y,scale:Math.max(.1,T.scale+k)}}if(g==="ROTATE"){const k=y.x+Q(d.current.getContext("2d"),y).w*y.scale/2,j=y.y+Q(d.current.getContext("2d"),y).h*y.scale/2;return{...y,rotation:Math.atan2(a-j,r-k)+Math.PI/2}}if(g==="CROP"){const k=-T.rotation,j=f*Math.cos(k)-N*Math.sin(k),O=f*Math.sin(k)+N*Math.cos(k),H=T.width,Y=T.height,R=T.scale,M=T.crop||{t:0,b:0,l:0,r:0},V=H/(1-M.l-M.r),W=Y/(1-M.t-M.b);let P={...M},le=0,te=0;if(C!=null&&C.includes("l")){const se=j/(V*R);P.l=Math.min(.9,Math.max(0,M.l+se)),le=(P.l-M.l)*V*R}else if(C!=null&&C.includes("r")){const se=-j/(V*R);P.r=Math.min(.9,Math.max(0,M.r+se))}if(C!=null&&C.includes("t")){const se=O/(W*R);P.t=Math.min(.9,Math.max(0,M.t+se)),te=(P.t-M.t)*W*R}else if(C!=null&&C.includes("b")){const se=-O/(W*R);P.b=Math.min(.9,Math.max(0,M.b+se))}const me=V*(1-P.l-P.r),pe=W*(1-P.t-P.b),A=T.rotation,ge=le*Math.cos(A)-te*Math.sin(A),he=le*Math.sin(A)+te*Math.cos(A);return{...y,crop:P,width:me,height:pe,x:T.x+ge,y:T.y+he}}return y});i({overlays:p})},ee=()=>{L("NONE")};return e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black overflow-hidden touch-none",children:e.jsx("canvas",{ref:d,width:z,height:B,onMouseDown:_,onMouseMove:S,onMouseUp:ee,onMouseLeave:ee,onTouchStart:_,onTouchMove:S,onTouchEnd:ee,className:"max-w-full max-h-full object-contain cursor-crosshair touch-none"})})},Ce=[{name:"Ê®ôÊ•∑È´î (KaiTi)",value:'"DFKai-SB", "KaiTi", serif'},{name:"ËÉñËÉñÈ´î (Mochiy)",value:'"Mochiy Pop One", sans-serif'},{name:"Á≤âÂúìÈ´î (Huninn)",value:'"jf-openhuninn-1.1", sans-serif'},{name:"Á´•Á´•È´î (Marker)",value:'"LXGW Marker Gothic", sans-serif'},{name:"ÈªûÈô£È´î (Pixel)",value:'"DotGothic16", sans-serif'},{name:"ÈªëÈ´î (Noto Sans)",value:'"Noto Sans TC", sans-serif'}],Ge=["‚ù§Ô∏è","‚≠ê","üî•","‚ú®","üçÄ","üé®","üöÄ","üì∑","üí°","üåà","üê±","üê∂"],Re=l=>new Promise((D,w)=>{const h=new Image;h.crossOrigin="anonymous",h.onload=()=>{const i=document.createElement("canvas"),c=1280;let d=h.width,u=h.height;d>c&&(u*=c/d,d=c),i.width=d,i.height=u,i.getContext("2d").drawImage(h,0,0,d,u),D(i.toDataURL("image/jpeg",.7))},h.onerror=w,h.src=l}),$e=l=>new Promise((D,w)=>{const h=document.createElement("video");h.src=l,h.muted=!0,h.crossOrigin="anonymous",h.onloadedmetadata=()=>{const i=document.createElement("canvas");i.width=640,i.height=360;const c=i.getContext("2d"),d=i.captureStream(24),u=new MediaRecorder(d,{mimeType:"video/webm;codecs=vp8",videoBitsPerSecond:1e6}),v=[];u.ondataavailable=E=>v.push(E.data),u.onstop=()=>{const E=new Blob(v,{type:"video/webm"}),g=new FileReader;g.onloadend=()=>D(g.result),g.readAsDataURL(E)},h.play(),u.start();const U=()=>{if(h.paused||h.ended){u.stop();return}c.drawImage(h,0,0,i.width,i.height),requestAnimationFrame(U)};U()},h.onerror=w}),He=l=>typeof l=="string"?Promise.resolve(l):new Promise((D,w)=>{const h=new FileReader;h.onload=()=>D(h.result),h.onerror=w,h.readAsDataURL(l)}),Ve=async(l,D,w,h)=>{const i=D.length+w.length;let c=0;const d=[];for(const L of D){let C="";try{L.type==="video"?C=await $e(L.previewUrl):C=await Re(L.previewUrl)}catch($){console.error("Failed to compress asset",L.id,$),C=L.previewUrl}const J=[];for(const $ of L.overlays)if($.type==="image"&&$.sourceUrl){const re=await Re($.sourceUrl);J.push({...$,sourceUrl:re})}else J.push($);d.push({...L,previewUrl:C,overlays:J,file:void 0}),c++,h(Math.floor(c/i*100))}const u=[];for(const L of w){const C=await He(L.url);u.push({...L,url:C,file:void 0}),c++,h(Math.floor(c/i*100))}const v={version:"1.0",settings:l,media:d,audioTracks:u},U=new Blob([JSON.stringify(v)],{type:"application/json"}),E=URL.createObjectURL(U),g=document.createElement("a");g.href=E,g.download=`${l.outputFileName}_project.ezp`,g.click(),URL.revokeObjectURL(E)},We=async l=>new Promise((D,w)=>{const h=new FileReader;h.onload=async i=>{var c;try{const d=JSON.parse((c=i.target)==null?void 0:c.result);d.media=d.media.map(u=>{const v=we(u.previewUrl),U=URL.createObjectURL(v),E=u.overlays.map(g=>{if(g.type==="image"&&g.sourceUrl){const L=we(g.sourceUrl);return{...g,sourceUrl:URL.createObjectURL(L)}}return g});return{...u,previewUrl:U,overlays:E}}),d.audioTracks=d.audioTracks.map(u=>{const v=we(u.url);return{...u,url:URL.createObjectURL(v)}}),D(d)}catch(d){w(d)}},h.onerror=w,h.readAsText(l)});function we(l){const D=atob(l.split(",")[1]),w=l.split(",")[0].split(":")[1].split(";")[0],h=new ArrayBuffer(D.length),i=new Uint8Array(h);for(let c=0;c<D.length;c++)i[c]=D.charCodeAt(c);return new Blob([h],{type:w})}const ze=ke.lazy(()=>Ne(()=>import("./VideoPreview-CUwyc-D6.js"),__vite__mapDeps([0,1]))),Be="208217318300-e58p9c688o3n0f11rpm9bnntnhqrp18a.apps.googleusercontent.com",Ye="AIzaSyAo41JycYePmA6kE841jJ9-fk4BUMKLao8",Ke=Be,Xe=Ye,qe={[G.FADE]:"Ê∑°ÂÖ•Ê∑°Âá∫",[G.SLIDE_UP]:"Âêë‰∏äÊªëÂãï",[G.SLIDE_DOWN]:"Âêë‰∏ãÊªëÂãï",[G.SLIDE_LEFT]:"ÂêëÂ∑¶ÊªëÂãï",[G.SLIDE_RIGHT]:"ÂêëÂè≥ÊªëÂãï",[G.ZOOM_IN]:"Á∏ÆÊîæÈÄ≤ÂÖ•",[G.RANDOM]:"Èö®Ê©üËΩâÂ†¥"},je=[{name:"Êô®ÈúßÁÅ∞",start:"#e8eaeb",end:"#9ca6a9"},{name:"Êùè‰ªÅÁôΩ",start:"#f6f0ea",end:"#d0b8ac"},{name:"Èº†Â∞æËçâ",start:"#e6ebe0",end:"#9bc4bc"},{name:"ÈùúË¨êËóç",start:"#e0e7eb",end:"#9fb8cd"},{name:"‰πæÁá•Áé´Áë∞",start:"#f5e6e8",end:"#d4a5a5"},{name:"ÊöñÊ≤ôÈáë",start:"#fdfbf7",end:"#d4c5b0"},{name:"Ê•µÁ∞°Èªë",start:"#2c3e50",end:"#000000"},{name:"Á¥îÊ∑®ÁôΩ",start:"#ffffff",end:"#f0f0f0"}],Je=()=>{const[l,D]=m.useState(q.EDITING),[w,h]=m.useState("media"),[i,c]=m.useState([]),[d,u]=m.useState([]),[v,U]=m.useState(null),[E,g]=m.useState(null),[L,C]=m.useState(0),[J,$]=m.useState([]),[re,T]=m.useState(!1),[Z,z]=m.useState(!1),[B,ae]=m.useState(0),[Q,oe]=m.useState(!1),[ne,_]=m.useState(!1),[S,ee]=m.useState({outputFileName:"ÊàëÁöÑÁ≤æÂΩ©ÂΩ±Áâá",aspectRatio:"16:9",photoDuration:3,transitionDuration:1,resolution:{width:1280,height:720},collageTitle:"ÊàëÁöÑÁ≤æÂΩ©ÂõûÊÜ∂",defaultTransition:G.RANDOM}),x=m.useRef(null),r=m.useRef(null),a=m.useRef(null),f=m.useRef(null),N=m.useRef(null),p=m.useRef(null),[y,k]=m.useState(null),j=m.useRef(null),O=m.useRef(null);m.useEffect(()=>{g(null),z(!1)},[v]),m.useEffect(()=>{if(v){const t=i.findIndex(s=>s.id===v);t!==-1&&t!==L&&C(t)}},[i,v]);const H=()=>new Promise((t,s)=>{if(window.google&&window.google.picker){t();return}if(!window.gapi){s(new Error("Google API script (gapi) not found"));return}window.gapi.load("picker",{callback:()=>{window.google&&window.google.picker?(console.log("Google Picker API loaded successfully via helper"),t()):s(new Error("Picker script loaded but window.google.picker is undefined"))},onerror:()=>s(new Error("Failed to load Google Picker script"))})});m.useEffect(()=>{const t=()=>{if(window.google&&window.google.accounts&&!j.current)try{j.current=google.accounts.oauth2.initTokenClient({client_id:Ke,scope:"https://www.googleapis.com/auth/drive.readonly",callback:n=>{if(n.error){console.error("Google Auth Error:",n),_(!1),alert(`Google ÁôªÂÖ•Â§±Êïó (${n.error})„ÄÇ

Â¶ÇÊûúÊÇ®ÁúãÂà∞ 403 ÈåØË™§ÔºåË´ãÁ¢∫Ë™çÊÇ®ÁöÑ Google Cloud Console Ë®≠ÂÆöÔºö
1. Â∑≤Â∞áÊ≠§Á∂≤Á´ôÁ∂≤ÂùÄÂä†ÂÖ•„ÄåÂ∑≤ÊéàÊ¨äÁöÑ JavaScript ‰æÜÊ∫ê„Äç„ÄÇ
2. ÊÇ®ÁöÑÊ∏¨Ë©¶Â∏≥ËôüÂ∑≤Âä†ÂÖ•ÁôΩÂêçÂñÆ (Â¶ÇÊûúÊòØÊ∏¨Ë©¶Ê®°Âºè)„ÄÇ`);return}n.access_token?(k(n.access_token),O.current?(R(n.access_token,O.current),O.current=null):_(!1)):_(!1)}})}catch(n){console.error("Token Client init failed:",n)}};window.gapi&&H().catch(n=>console.log("Pre-load picker failed, will retry on click:",n));const s=setInterval(()=>{window.google&&window.google.accounts&&!j.current&&t(),j.current&&clearInterval(s)},500);return()=>clearInterval(s)},[]);const Y=async t=>{_(!0);try{await H()}catch(s){console.error(s),alert("ÁÑ°Ê≥ïËºâÂÖ• Google ÂÖÉ‰ª∂ÔºåË´ãÊ™¢Êü•Á∂≤Ë∑ØÈÄ£Á∑öÊàñÂà∑Êñ∞È†ÅÈù¢„ÄÇ"),_(!1);return}if(y){R(y,t);return}O.current=t,j.current?j.current.requestAccessToken({prompt:""}):(alert("Google ÁôªÂÖ•ÂÖÉ‰ª∂Â∞öÊú™ËºâÂÖ•ÂÆåÊàêÔºåË´ãÁ®çÂæåÂÜçË©¶„ÄÇ"),_(!1))},R=async(t,s)=>{try{(!window.google||!window.google.picker)&&await H();const n=["image/png","image/jpeg","image/jpg","image/bmp","image/gif","image/tiff","image/webp","image/heic","image/heif","video/mp4","video/mpeg","video/ogg","video/webm","video/quicktime","video/x-msvideo","video/x-matroska","video/3gpp"].join(","),o=new google.picker.PickerBuilder().setOAuthToken(t).setDeveloperKey(Xe).setOrigin(window.location.origin).setCallback(async ie=>{if(ie.action===google.picker.Action.PICKED){_(!0);const xe=ie.docs,fe=[];for(const F of xe)try{const ce=F.id,ue=await fetch(`https://www.googleapis.com/drive/v3/files/${ce}?alt=media`,{headers:{Authorization:`Bearer ${t}`}});if(!ue.ok)throw console.warn(`Drive download failed for ${F.name} (${ce}). Status: ${ue.status}`),new Error(`Fetch failed: ${ue.status}`);let ve=await ue.blob();if(F.mimeType==="image/heic"||F.mimeType==="image/heif"||F.name.toLowerCase().endsWith(".heic")||F.name.toLowerCase().endsWith(".heif"))try{const Oe=(await Ne(()=>import("./vendor--FBYh3JU.js").then(Pe=>Pe.h),[])).default,ye=await Oe({blob:ve,toType:"image/jpeg",quality:.8});ve=Array.isArray(ye)?ye[0]:ye,console.log("Drive HEIC file converted to JPEG successfully")}catch(Ie){console.error("HEIC conversion failed for Drive file:",Ie)}const Ue=URL.createObjectURL(ve),Ee=F.mimeType.startsWith("video/");fe.push({id:crypto.randomUUID(),type:Ee?"video":"image",fileName:F.name,previewUrl:Ue,duration:Ee?5:S.photoDuration,transition:S.defaultTransition,overlays:[]})}catch(ce){console.error("Failed to download Google file:",ce)}c(F=>[...F,...fe]),u(F=>[...fe,...F]),_(!1)}else ie.action===google.picker.Action.CANCEL&&_(!1)}),I=new google.picker.DocsView(google.picker.ViewId.DOCS).setParent("root").setIncludeFolders(!0).setSelectFolderEnabled(!1).setMimeTypes(n).setLabel("ÊàëÁöÑÈõ≤Á´ØÁ°¨Á¢ü");o.addView(I);const X=new google.picker.DocsView(google.picker.ViewId.RECENTLY_PICKED).setMimeTypes(n).setLabel("ËøëÊúü‰ΩøÁî®");o.addView(X);const de=new google.picker.DocsView(google.picker.ViewId.DOCS).setEnableDrives(!0).setIncludeFolders(!0).setMimeTypes(n).setLabel("ÂÖ±Áî®Èõ≤Á´ØÁ°¨Á¢ü");if(o.addView(de),s==="photos"){const ie=new google.picker.DocsView(google.picker.ViewId.DOCS).setParent("root").setIncludeFolders(!0).setMimeTypes("image/png,image/jpeg,image/jpg,image/heic").setLabel("ÂúñÁâáÊêúÂ∞ã");o.addView(ie)}o.enableFeature(google.picker.Feature.SUPPORT_DRIVES),o.enableFeature(google.picker.Feature.MULTISELECT_ENABLED),o.build().setVisible(!0)}catch(n){console.error("Create Picker Error:",n),_(!1),alert(`ÁÑ°Ê≥ïÂª∫Á´ã Picker„ÄÇ
Â¶ÇÊûúÊÇ®ÁúãÂà∞ 403 ÈåØË™§ÔºåË´ãÊ™¢Êü•ÊÇ®ÁöÑ Google API Key ÊòØÂê¶ÂÖÅË®±Ê≠§Á∂≤Âüü (HTTP Referrer)„ÄÇ`)}},M=async t=>{if(t.target.files&&t.target.files.length>0){_(!0);const s=Array.from(t.target.files),n=[];try{for(const o of s){let I=o,X="";if(o.name.toLowerCase().endsWith(".heic")||o.name.toLowerCase().endsWith(".heif")||o.type==="image/heic"||o.type==="image/heif")try{const fe=(await Ne(()=>import("./vendor--FBYh3JU.js").then(ue=>ue.h),[])).default,F=await fe({blob:o,toType:"image/jpeg",quality:.8}),ce=Array.isArray(F)?F[0]:F;I=new File([ce],o.name.replace(/\.heic$/i,".jpg"),{type:"image/jpeg"}),X=URL.createObjectURL(ce)}catch(xe){console.error("HEIC ËΩâÊèõÂ§±Êïó",xe);continue}else X=URL.createObjectURL(o);const be=I.type.startsWith("video/"),ie={id:crypto.randomUUID(),type:be?"video":"image",fileName:I.name,previewUrl:X,file:I,duration:be?5:S.photoDuration,transition:S.defaultTransition,overlays:[]};n.push(ie)}c(o=>[...o,...n]),u(o=>[...n,...o])}catch(o){console.error("ÂåØÂÖ•Ê™îÊ°àÊôÇÁôºÁîüÈåØË™§",o)}finally{_(!1),a.current&&(a.current.value="")}}},V=async()=>{if(i.length===0)return alert("Ê≤íÊúâÁ¥†ÊùêÂèØ‰ª•ÂÑ≤Â≠òÔºÅ");oe(!0),ae(0);try{await Ve(S,i,J,ae)}catch(t){alert("ÂÑ≤Â≠òÂ§±ÊïóÔºö"+t)}oe(!1)},W=async t=>{var n;const s=(n=t.target.files)==null?void 0:n[0];if(s){oe(!0),ae(0);try{const o=await We(s);ee(o.settings),c(o.media),u([]),$(o.audioTracks),o.media.length>0&&U(o.media[0].id)}catch{alert("ËºâÂÖ•Â∞àÊ°àÂ§±ÊïóÔºåË´ãÁ¢∫‰øùÊ™îÊ°àÊ†ºÂºèÊ≠£Á¢∫ (.ezp)")}oe(!1),f.current&&(f.current.value="")}},P=()=>{i.length===0&&d.length===0&&J.length===0||confirm(`Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÂÖßÂÆπ‰∏¶ÈáçÊñ∞ÈñãÂßãÂóéÔºü
Ê≠§Âãï‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ`)&&(c([]),u([]),$([]),U(null),g(null),C(0),D(q.EDITING),ee({outputFileName:"ÊàëÁöÑÁ≤æÂΩ©ÂΩ±Áâá",aspectRatio:"16:9",photoDuration:3,transitionDuration:1,resolution:{width:1280,height:720},collageTitle:"ÊàëÁöÑÁ≤æÂΩ©ÂõûÊÜ∂",defaultTransition:G.RANDOM}),a.current&&(a.current.value=""),x.current&&(x.current.value=""),f.current&&(f.current.value=""))},le=()=>{const t=crypto.randomUUID(),s={id:t,type:"image",fileName:"Á©∫ÁôΩÊãºË≤º",previewUrl:"",duration:S.photoDuration,transition:G.FADE,overlays:[],gradientColors:je[0]};c(n=>[s,...n]),U(t),C(0)},te=t=>{if(!v){i.some(n=>n.id===t.id)||c(n=>[...n,t]),U(t.id),u(n=>n.filter(o=>o.id!==t.id));return}const s={id:crypto.randomUUID(),type:"image",sourceUrl:t.previewUrl,x:S.resolution.width/2-200,y:S.resolution.height/2-150,width:400,height:300,scale:1,rotation:0,zIndex:50,crop:{t:0,b:0,l:0,r:0}};c(n=>n.map(I=>I.id===v?{...I,overlays:[...I.overlays,s]}:I).filter(I=>I.id===v||I.id!==t.id)),g(s.id),u(n=>n.filter(o=>o.id!==t.id))},me=t=>{const s=i.find(n=>n.id===t);s&&s.fileName!=="Á©∫ÁôΩÊãºË≤º"&&u(n=>n.some(o=>o.id===s.id)?n:[s,...n]),c(n=>n.filter(o=>o.id!==t)),v===t&&U(null)},pe=t=>{if(t.target.files){const n=Array.from(t.target.files).map(o=>({file:o,url:URL.createObjectURL(o),name:o.name,duration:30}));$(o=>[...o,...n]),T(!1)}},A=(t,s)=>{if(s.overlays){const n=i.find(o=>o.id===t);n&&n.overlays.filter(I=>{var X;return!((X=s.overlays)!=null&&X.find(de=>de.id===I.id))}).forEach(I=>{I.type==="image"&&I.sourceUrl&&u(X=>[{id:crypto.randomUUID(),type:"image",previewUrl:I.sourceUrl,fileName:"ÈÇÑÂéüÁöÑÁ¥†Êùê",duration:S.photoDuration,transition:G.FADE,overlays:[]},...X])})}c(n=>n.map(o=>o.id===t?{...o,...s}:o))},ge=t=>{let s=1280,n=720;t==="4:3"?(s=1024,n=768):t==="9:16"?(s=720,n=1280):t==="1:1"&&(s=1080,n=1080),ee(o=>({...o,aspectRatio:t,resolution:{width:s,height:n}}))},he=(t,s)=>{if(!v)return;const n={id:crypto.randomUUID(),type:t,x:S.resolution.width/2-200,y:S.resolution.height/2-50,width:t==="text"?400:100,height:100,scale:1,rotation:0,zIndex:100,text:t==="text"?"Ë´ãËº∏ÂÖ•ÊñáÂ≠óÂÖßÂÆπ":void 0,emoji:t==="sticker"?s:void 0,fontFamily:Ce[0].value,fontSize:60,color:"#ffffff",backgroundColor:"#000000",backgroundOpacity:.7,backgroundPadding:20,backgroundRadius:10,strokeColor:"#000000",strokeWidth:0,animationType:t==="sticker"?"pulse":"none"};c(o=>o.map(I=>I.id===v?{...I,overlays:[...I.overlays,n]}:I)),g(n.id),t==="text"&&h("text")},se=()=>{if(N.current===null||p.current===null)return;const t=[...i],s=t.splice(N.current,1)[0];t.splice(p.current,0,s),N.current=null,p.current=null,c(t)},Le=()=>{if(i.length===0){alert("Ë´ãÂÖàÊñ∞Â¢ûÂ†¥ÊôØÁ¥†ÊùêÔºÅ");return}D(q.RENDERING),ae(0)},Me=t=>{const s=document.createElement("a");s.href=t,s.download=`${S.outputFileName}.webm`,document.body.appendChild(s),s.click(),document.body.removeChild(s),D(q.FINISHED),setTimeout(()=>{D(q.EDITING)},2e3)},b=i.find(t=>t.id===v),K=b==null?void 0:b.overlays.find(t=>t.id===E);return e.jsxs("div",{className:"fixed inset-0 bg-[#0b0e14] text-slate-100 flex flex-col overflow-hidden font-sans select-none touch-none",children:[e.jsxs("header",{className:"h-14 shrink-0 px-4 md:px-6 flex justify-between items-center bg-[#161b22] border-b border-slate-800/50 z-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center font-black italic text-sm",children:"E"}),e.jsx("h1",{className:"text-lg font-black tracking-tighter italic text-slate-200 uppercase hidden md:block",children:"Easymaker 123"})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx("button",{onClick:P,className:"px-3 py-1.5 md:px-4 bg-red-900/20 hover:bg-red-900/40 text-red-400 border border-red-900/50 rounded-full text-[10px] font-black uppercase tracking-widest transition-all active:scale-95",children:"ÈáçÊñ∞ÈñãÂßã"}),e.jsx("button",{onClick:()=>{var t;return(t=f.current)==null?void 0:t.click()},className:"px-3 py-1.5 md:px-4 bg-slate-800 hover:bg-slate-700 rounded-full text-[10px] font-black uppercase tracking-widest border border-slate-700 transition-all active:scale-95",children:"ÈñãÂïü"}),e.jsx("input",{type:"file",ref:f,accept:".ezp",className:"hidden",onChange:W}),e.jsx("button",{onClick:V,className:"px-3 py-1.5 md:px-4 bg-slate-800 hover:bg-slate-700 rounded-full text-[10px] font-black uppercase tracking-widest border border-slate-700 transition-all active:scale-95",children:"ÂÑ≤Â≠ò"}),e.jsx("button",{onClick:Le,disabled:l===q.RENDERING,className:`bg-indigo-600 hover:bg-indigo-500 px-4 md:px-6 py-1.5 rounded-full text-xs font-black shadow-lg shadow-indigo-500/20 transition-all active:scale-95 ${l===q.RENDERING?"opacity-50 cursor-not-allowed":""}`,children:l===q.RENDERING?`${B}%`:"ÂåØÂá∫"})]})]}),e.jsxs("main",{className:"flex-1 flex flex-col md:flex-row overflow-hidden min-h-0 relative",children:[e.jsxs("aside",{className:"order-last md:order-first w-full md:w-[340px] h-[35vh] md:h-full shrink-0 bg-[#161b22] flex flex-col border-t md:border-r border-slate-800/50 overflow-hidden relative z-20",children:[e.jsx("div",{className:"flex border-b border-slate-800/30 shrink-0 md:flex-row order-last md:order-first",children:[{id:"media",icon:"üñºÔ∏è",label:"Â™íÈ´î"},{id:"audio",icon:"üéµ",label:"Èü≥Ê®Ç"},{id:"sticker",icon:"üòä",label:"Ë≤ºÂúñ"},{id:"text",icon:"üìù",label:"ÊñáÂ≠ó"},{id:"settings",icon:"‚öôÔ∏è",label:"Ë®≠ÂÆö"}].map(t=>e.jsxs("button",{onClick:()=>h(t.id),className:`flex-1 flex flex-col items-center py-2 md:py-3 gap-1 transition-all ${w===t.id?"bg-indigo-600/10 text-indigo-400 border-t-2 md:border-t-0 md:border-b-2 border-indigo-500":"text-slate-500 hover:text-slate-300"}`,children:[e.jsx("span",{className:t.id==="text"?"text-sm font-black":"text-lg",children:t.icon}),e.jsx("span",{className:"text-[9px] md:text-[10px] font-bold tracking-widest",children:t.label})]},t.id))}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-5 scrollbar-thin bg-[#161b22]",children:[w==="media"&&e.jsxs("div",{className:"space-y-4 md:space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 md:gap-3",children:[e.jsxs("button",{onClick:()=>{var t;return(t=a.current)==null?void 0:t.click()},className:"col-span-2 py-3 md:py-4 bg-slate-800/40 border border-slate-700/50 rounded-2xl flex items-center justify-center gap-2 hover:bg-slate-700/60 transition-all active:scale-95 group",children:[e.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:"üì§"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"ÂåØÂÖ•Êú¨Âú∞"})]}),e.jsxs("button",{onClick:()=>Y("docs"),className:"py-2 md:py-3 bg-blue-600/10 border border-blue-500/20 rounded-2xl flex flex-col items-center justify-center gap-1 hover:bg-blue-600/20 transition-all active:scale-95",children:[e.jsx("span",{className:"text-xl",children:"üìÅ"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-blue-400",children:"Drive"})]}),e.jsxs("button",{onClick:()=>Y("photos"),className:"py-2 md:py-3 bg-emerald-600/10 border border-emerald-500/20 rounded-2xl flex flex-col items-center justify-center gap-1 hover:bg-emerald-600/20 transition-all active:scale-95",children:[e.jsx("span",{className:"text-xl",children:"üåà"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-400",children:"Photos"})]}),e.jsxs("button",{onClick:le,className:"col-span-2 py-2 md:py-3 bg-indigo-600/10 border border-indigo-500/20 rounded-2xl flex items-center justify-center gap-2 hover:bg-indigo-600/20 transition-all active:scale-95",children:[e.jsx("span",{className:"text-xl",children:"üß©"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Êñ∞Â¢ûÁ©∫ÁôΩÊãºË≤º"})]})]}),e.jsx("input",{type:"file",ref:a,multiple:!0,accept:"image/*,video/*,.heic,.HEIC,.mov,.mp4,.webm,.mkv,.avi,.gif,.webp",onChange:M,className:"hidden"}),e.jsxs("div",{className:"space-y-2 md:space-y-3 mt-4",children:[e.jsxs("h3",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:["ÂæÖ‰ΩøÁî® (",d.length,")"]}),d.length>0?e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-2 gap-2",children:d.map(t=>e.jsx("div",{className:"aspect-video bg-[#0b0e14] rounded-xl overflow-hidden border border-slate-800 group relative cursor-pointer",onClick:()=>te(t),children:e.jsx("img",{src:t.previewUrl,className:"w-full h-full object-cover transition-transform group-hover:scale-110",alt:""})},t.id))}):e.jsx("div",{className:"py-8 border border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center opacity-40 text-center",children:e.jsx("p",{className:"text-[9px] font-bold uppercase",children:"ÁÑ°ÂèØÁî®Á¥†Êùê"})})]})]}),w==="audio"&&e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-left-4 duration-300",children:[e.jsxs("button",{onClick:()=>{var t;return(t=x.current)==null?void 0:t.click()},className:"w-full py-4 bg-slate-800/40 border border-slate-700/50 rounded-2xl flex items-center justify-center gap-3 hover:bg-slate-700 transition-colors",children:[e.jsx("span",{className:"text-xl",children:"üìÅ"}),e.jsx("span",{className:"text-xs font-black",children:"Êú¨Âú∞Èü≥Ê®ÇÂåØÂÖ•"})]}),e.jsxs("button",{onClick:()=>T(!0),className:"w-full py-4 bg-red-600/10 border border-red-500/20 rounded-2xl flex items-center justify-center gap-3 hover:bg-red-600/20 text-red-500 transition-colors",children:[e.jsx("span",{className:"text-xl",children:"üé¨"}),e.jsx("span",{className:"text-xs font-black",children:"YouTube ‰∏ãËºâ"})]}),e.jsx("input",{type:"file",ref:x,accept:"audio/*",className:"hidden",multiple:!0,onChange:pe}),J.length>0&&e.jsx("div",{className:"space-y-2 pt-2",children:J.map(t=>e.jsxs("div",{className:"p-3 bg-[#0b0e14] rounded-xl border border-slate-800 flex items-center gap-3 group",children:[e.jsx("span",{className:"text-lg",children:"üéµ"}),e.jsx("span",{className:"text-[10px] font-bold truncate flex-1",children:t.name}),e.jsx("button",{onClick:()=>$(s=>s.filter(n=>n.url!==t.url)),className:"text-red-500 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity",children:"‚úï"})]},t.url))})]}),w==="sticker"&&e.jsx("div",{className:"grid grid-cols-4 gap-2 animate-in fade-in duration-300",children:Ge.map(t=>e.jsx("button",{onClick:()=>he("sticker",t),className:"aspect-square bg-slate-800/40 rounded-xl hover:bg-slate-700 text-2xl flex items-center justify-center transition-all active:scale-90",children:t},t))}),w==="text"&&e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-left-4 duration-300 h-full flex flex-col",children:[e.jsxs("button",{onClick:()=>he("text"),className:"shrink-0 w-full py-3 bg-indigo-600 text-white rounded-2xl text-xs font-black shadow-lg shadow-indigo-500/20 active:scale-95 transition-all flex items-center justify-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:"Ôºã"})," Êñ∞Â¢ûÊñáÂ≠ó"]}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-1 scrollbar-thin",children:K&&K.type==="text"?e.jsxs("div",{className:"space-y-4 pt-2 border-t border-slate-800/50",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest",children:"Á∑®ËºØ‰∏≠"}),e.jsx("button",{onClick:()=>{A(b.id,{overlays:b.overlays.filter(t=>t.id!==E)}),g(null)},className:"text-red-500 text-[10px] font-black hover:underline",children:"Âà™Èô§"})]}),e.jsx("div",{className:"space-y-1",children:e.jsx("textarea",{value:K.text,onChange:t=>A(b.id,{overlays:b.overlays.map(s=>s.id===E?{...s,text:t.target.value}:s)}),className:"w-full bg-[#0b0e14] border border-slate-700 p-2 rounded-xl text-xs font-medium outline-none focus:border-indigo-500",rows:2})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("select",{value:K.fontFamily,onChange:t=>A(b.id,{overlays:b.overlays.map(s=>s.id===E?{...s,fontFamily:t.target.value}:s)}),className:"w-full bg-[#0b0e14] border border-slate-700 p-2 rounded-xl text-[10px] font-bold focus:border-indigo-500 outline-none",children:Ce.map(t=>e.jsx("option",{value:t.value,children:t.name},t.value))}),e.jsx("input",{type:"color",value:K.color,onChange:t=>A(b.id,{overlays:b.overlays.map(s=>s.id===E?{...s,color:t.target.value}:s)}),className:"w-full h-10 rounded-lg bg-[#0b0e14] border border-slate-700 p-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_40px] gap-2 items-center",children:[e.jsx("span",{className:"text-[9px] text-slate-500",children:"Â§ñÊ°Ü"}),e.jsx("input",{type:"color",value:K.strokeColor,onChange:t=>A(b.id,{overlays:b.overlays.map(s=>s.id===E?{...s,strokeColor:t.target.value}:s)}),className:"w-full h-6 rounded-lg bg-transparent border-none"})]}),e.jsx("input",{type:"range",min:"0",max:"20",value:K.strokeWidth,onChange:t=>A(b.id,{overlays:b.overlays.map(s=>s.id===E?{...s,strokeWidth:parseInt(t.target.value)}:s)}),className:"w-full h-1 bg-slate-700 rounded-full appearance-none accent-indigo-500"})]}),e.jsxs("div",{className:"space-y-2 pt-3 mt-2 border-t border-slate-800/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-[9px] text-slate-500 font-bold uppercase tracking-widest",children:"ÊñáÂ≠óÂ∫ïÊ°Ü"}),K.backgroundColor&&e.jsx("button",{onClick:()=>A(b.id,{overlays:b.overlays.map(t=>t.id===E?{...t,backgroundColor:""}:t)}),className:"text-[9px] text-red-400 hover:text-red-300",children:"ÁßªÈô§"})]}),e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-3 items-center",children:[e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx("div",{className:"relative w-8 h-8 rounded-lg overflow-hidden border border-slate-700",children:e.jsx("input",{type:"color",value:K.backgroundColor||"#000000",onChange:t=>A(b.id,{overlays:b.overlays.map(s=>s.id===E?{...s,backgroundColor:t.target.value}:s)}),className:"absolute inset-[-50%] w-[200%] h-[200%] cursor-pointer"})}),e.jsx("span",{className:"text-[8px] text-slate-500",children:"È°èËâ≤"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[8px] text-slate-500 w-6",children:"ÈÄèÊòé"}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:K.backgroundOpacity??.7,onChange:t=>A(b.id,{overlays:b.overlays.map(s=>s.id===E?{...s,backgroundOpacity:parseFloat(t.target.value)}:s)}),className:"flex-1 h-1 bg-slate-700 rounded-full appearance-none accent-indigo-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[8px] text-slate-500 w-6",children:"ÂúìËßí"}),e.jsx("input",{type:"range",min:"0",max:"50",value:K.backgroundRadius??10,onChange:t=>A(b.id,{overlays:b.overlays.map(s=>s.id===E?{...s,backgroundRadius:parseInt(t.target.value)}:s)}),className:"flex-1 h-1 bg-slate-700 rounded-full appearance-none accent-indigo-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[8px] text-slate-500 w-6",children:"ÂÖßË∑ù"}),e.jsx("input",{type:"range",min:"0",max:"50",value:K.backgroundPadding??20,onChange:t=>A(b.id,{overlays:b.overlays.map(s=>s.id===E?{...s,backgroundPadding:parseInt(t.target.value)}:s)}),className:"flex-1 h-1 bg-slate-700 rounded-full appearance-none accent-indigo-500"})]})]})]})]})]}):e.jsx("div",{className:"flex flex-col items-center justify-center py-10 opacity-40",children:e.jsx("p",{className:"text-[10px] font-black uppercase",children:"Ë´ãÈÅ∏ÊìáÊñáÂ≠ó"})})})]}),w==="settings"&&e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-left-4 duration-300",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Ê™îÂêç"}),e.jsx("input",{type:"text",value:S.outputFileName,onChange:t=>ee({...S,outputFileName:t.target.value}),className:"w-full bg-[#0b0e14] border border-slate-700 p-2 rounded-xl text-xs font-bold focus:border-indigo-500 outline-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"ÊØî‰æã"}),e.jsx("div",{className:"grid grid-cols-4 gap-1",children:["16:9","4:3","9:16","1:1"].map(t=>e.jsx("button",{onClick:()=>ge(t),className:`py-1.5 px-1 rounded-lg text-[9px] font-black border transition-all ${S.aspectRatio===t?"bg-indigo-600 border-indigo-500 text-white":"bg-slate-800/40 border-slate-700 text-slate-400"}`,children:t},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"ÁÖßÁâáÁßíÊï∏"}),e.jsxs("span",{className:"text-xs font-black text-indigo-400",children:[S.photoDuration,"s"]})]}),e.jsx("input",{type:"range",min:"1",max:"10",step:"0.5",value:S.photoDuration,onChange:t=>ee({...S,photoDuration:parseFloat(t.target.value)}),className:"w-full h-1 bg-slate-700 rounded-full appearance-none accent-indigo-500"})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-800/50 space-y-2",children:[e.jsx("h3",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Ê≥ïÂæãË≥áË®ä"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("a",{href:"https://alice55505-source.github.io/-123/privacy.html",target:"_blank",rel:"noreferrer",className:"text-xs font-bold text-slate-400 hover:text-indigo-400 transition-colors flex items-center gap-2 px-2 py-2 rounded-lg hover:bg-slate-800/50",children:[e.jsx("span",{children:"üõ°Ô∏è"})," Èö±ÁßÅÊ¨äÊîøÁ≠ñ"]}),e.jsxs("a",{href:"https://alice55505-source.github.io/-123/terms.html",target:"_blank",rel:"noreferrer",className:"text-xs font-bold text-slate-400 hover:text-indigo-400 transition-colors flex items-center gap-2 px-2 py-2 rounded-lg hover:bg-slate-800/50",children:[e.jsx("span",{children:"‚öñÔ∏è"})," ÊúçÂãôÊ¢ùÊ¨æ"]})]})]})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-[#0b0e14] h-full overflow-hidden relative order-first md:order-last",children:[e.jsxs("div",{className:"flex-1 p-4 md:p-8 flex items-center justify-center relative min-h-0 bg-[#0b0e14]",children:[e.jsxs("div",{className:"absolute top-2 left-4 md:top-6 md:left-8 z-10 flex flex-col gap-2 transition-opacity duration-500 opacity-100 pointer-events-none",children:[e.jsxs("div",{className:"px-3 py-1 bg-[#161b22]/90 backdrop-blur-md border border-slate-800/50 rounded-full flex items-center gap-2 shadow-2xl w-fit pointer-events-auto",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-[9px] md:text-[10px] font-black text-slate-300 uppercase tracking-[0.2em]",children:[L+1," / ",i.length]})]}),b&&b.type==="image"&&e.jsx("button",{onClick:()=>z(!Z),className:`px-3 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest transition-all shadow-xl pointer-events-auto w-fit ${Z?"bg-red-500 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:Z?"‚èπÔ∏è ÈÄÄÂá∫Ë£ÅÂâ™":"‚úÇÔ∏è Ë£ÅÂâ™"})]}),e.jsxs("div",{className:"flex items-center gap-6 h-full w-full justify-center",children:[e.jsx("div",{className:"w-full h-full max-w-[960px] aspect-video bg-black rounded-xl md:rounded-[3rem] overflow-hidden transition-all duration-700 relative group/canvas shadow-[0_0_50px_rgba(0,0,0,0.5)] border-[4px] md:border-[12px] border-[#161b22]",children:l===q.RENDERING?e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 font-bold",children:"ËºâÂÖ•È†êË¶ΩÂÖÉ‰ª∂‰∏≠..."}),children:e.jsx(ze,{mediaList:i,audio:J,settings:S,appState:l,onRenderingComplete:Me,onProgress:ae,setSelectedOverlayId:g})}):b?e.jsx(Fe,{item:b,settings:S,selectedOverlayId:E,setSelectedOverlayId:g,isCropMode:Z,onUpdate:t=>A(b.id,t)}):e.jsx("div",{className:"w-full h-full flex flex-col items-center justify-center gap-6 bg-gradient-to-br from-[#0b0e14] to-slate-900",children:e.jsx("span",{className:"text-4xl opacity-20",children:"üé®"})})}),e.jsx("div",{className:"hidden md:block",children:b&&b.fileName==="Á©∫ÁôΩÊãºË≤º"&&e.jsxs("div",{className:"w-[180px] shrink-0 bg-[#161b22]/90 backdrop-blur-md rounded-[2rem] p-4 flex flex-col gap-4 border border-slate-800/50 shadow-2xl h-[400px] animate-in slide-in-from-right-8 duration-500",children:[e.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest text-center py-2 border-b border-slate-700/50",children:"üé® Ëé´Ëò≠Ëø™ËÉåÊôØ"}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-1 scrollbar-thin",children:je.map((t,s)=>{var n;return e.jsx("button",{onClick:()=>A(b.id,{gradientColors:t}),className:`w-full aspect-video rounded-xl transition-all hover:scale-105 active:scale-95 border-2 relative overflow-hidden group ${((n=b.gradientColors)==null?void 0:n.name)===t.name?"border-white shadow-lg":"border-transparent hover:border-slate-500"}`,style:{background:`linear-gradient(135deg, ${t.start}, ${t.end})`}},s)})})]})})]})]}),e.jsxs("div",{className:"h-28 md:h-48 shrink-0 bg-[#161b22] border-t border-slate-800/50 flex flex-col px-4 md:px-8 py-3 md:py-5 z-20 transition-all duration-500",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 md:mb-4 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-[9px] md:text-[10px] text-slate-300 font-black tracking-widest uppercase",children:"ÊôÇÈñìËª∏"}),e.jsx("div",{className:"h-3 w-[1px] bg-slate-800"}),e.jsxs("span",{className:"text-[9px] md:text-[10px] text-slate-500 font-bold tracking-widest uppercase",children:[i.reduce((t,s)=>t+(s.type==="video"?s.duration||5:S.photoDuration),0).toFixed(1),"s"]})]}),b&&b.fileName==="Á©∫ÁôΩÊãºË≤º"&&e.jsxs("div",{className:"flex items-center gap-2 md:hidden overflow-x-auto scrollbar-thin max-w-[60%] pb-1",children:[e.jsx("span",{className:"text-[8px] text-slate-500 font-black shrink-0",children:"ËÉåÊôØ"}),je.map((t,s)=>{var n;return e.jsx("button",{onClick:()=>A(b.id,{gradientColors:t}),className:`w-6 h-6 rounded-full shrink-0 border-2 transition-transform ${((n=b.gradientColors)==null?void 0:n.name)===t.name?"border-white scale-110 shadow-md":"border-slate-700/50"}`,style:{background:`linear-gradient(135deg, ${t.start}, ${t.end})`},title:t.name},s)})]})]}),e.jsxs("div",{className:"flex-1 flex gap-2 md:gap-4 overflow-x-auto pb-2 scrollbar-thin min-h-0 items-center",children:[i.map((t,s)=>{var n;return e.jsxs(ke.Fragment,{children:[e.jsxs("div",{draggable:!0,onDragStart:()=>N.current=s,onDragEnter:()=>p.current=s,onDragEnd:se,onDragOver:o=>o.preventDefault(),onClick:()=>{U(t.id),C(s)},className:`relative shrink-0 h-full aspect-video rounded-lg md:rounded-2xl border-2 md:border-4 transition-all overflow-hidden cursor-pointer md:cursor-move group/thumb ${v===t.id?"border-indigo-600 ring-2 ring-indigo-500/20 z-10 scale-105 shadow-xl":"border-slate-800 opacity-60 hover:opacity-100 hover:border-slate-700"}`,style:t.fileName==="Á©∫ÁôΩÊãºË≤º"&&t.gradientColors?{background:`linear-gradient(135deg, ${t.gradientColors.start}, ${t.gradientColors.end})`}:{},children:[t.previewUrl?e.jsx("img",{src:t.previewUrl,className:"w-full h-full object-cover pointer-events-none",alt:""}):!t.gradientColors&&e.jsx("div",{className:"w-full h-full bg-slate-900 flex items-center justify-center text-xl pointer-events-none",children:"üß©"}),e.jsx("div",{className:"absolute bottom-1 left-1 px-1.5 py-0.5 bg-black/70 backdrop-blur-md rounded text-[8px] font-black text-white",children:s+1}),e.jsx("button",{onClick:o=>{o.stopPropagation(),me(t.id)},className:"absolute top-1 right-1 bg-red-600/90 text-white w-5 h-5 md:w-7 md:h-7 rounded-full text-[8px] md:text-[10px] flex items-center justify-center shadow-lg opacity-100 md:opacity-0 group-hover/thumb:opacity-100 transition-opacity",children:"‚úï"})]}),s<i.length-1&&e.jsx("div",{className:"shrink-0 flex items-center justify-center relative w-4 md:w-8 z-10",children:e.jsxs("button",{onClick:o=>{o.stopPropagation();const I=Object.values(G),X=I.indexOf(t.transition||G.RANDOM),de=I[(X+1)%I.length];A(t.id,{transition:de})},className:"w-5 h-5 md:w-6 md:h-6 rounded-full bg-slate-800 border border-slate-600 hover:border-indigo-500 hover:bg-indigo-600 flex items-center justify-center transition-all z-20 shadow-lg active:scale-90 group/trans",title:`ÁõÆÂâçËΩâÂ†¥: ${qe[t.transition||G.RANDOM]}`,children:[e.jsx("span",{className:"text-[8px] text-slate-400 hover:text-white group-hover/trans:hidden",children:"‚ö°"}),e.jsx("span",{className:"text-[7px] text-white hidden group-hover/trans:block font-black uppercase",children:t.transition===G.RANDOM?"R":(n=t.transition)==null?void 0:n.charAt(0)})]})})]},t.id)}),e.jsx("button",{onClick:le,className:"shrink-0 h-full aspect-video bg-[#0b0e14] border-2 border-dashed border-slate-800 rounded-lg md:rounded-3xl flex flex-col items-center justify-center gap-1 text-slate-600 hover:text-indigo-400 hover:border-indigo-600 transition-all hover:bg-slate-800/10 group active:scale-95",children:e.jsx("span",{className:"text-xl md:text-3xl group-hover:scale-110 transition-transform",children:"Ôºã"})})]})]})]})]}),re&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 flex items-center justify-center p-4 md:p-12 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-[#161b22] w-full max-w-5xl h-[85vh] rounded-[2rem] md:rounded-[4rem] flex flex-col overflow-hidden border border-slate-800 shadow-[0_0_150px_rgba(0,0,0,0.8)]",children:[e.jsxs("div",{className:"p-4 md:p-8 flex justify-between items-center bg-[#0b0e14]/50 border-b border-slate-800/30",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx("span",{className:"text-2xl md:text-3xl",children:"üì•"}),e.jsx("h2",{className:"font-black text-xs md:text-sm uppercase tracking-[0.3em]",children:"YouTube ÂåØÂÖ•"})]}),e.jsx("button",{onClick:()=>T(!1),className:"w-8 h-8 md:w-12 md:h-12 rounded-full hover:bg-slate-800 flex items-center justify-center text-slate-500 hover:text-white transition-all active:scale-90",children:"‚úï"})]}),e.jsx("iframe",{src:"https://ezconv.cc/",className:"flex-1 bg-white"}),e.jsxs("div",{className:"p-6 md:p-10 bg-[#0b0e14] flex flex-col items-center gap-4 md:gap-6",children:[e.jsx("button",{onClick:()=>{var t;return(t=r.current)==null?void 0:t.click()},className:"px-8 md:px-16 py-3 md:py-4 bg-red-600 hover:bg-red-500 text-white font-black rounded-full text-xs transition-all active:scale-95 shadow-2xl shadow-red-600/30 uppercase tracking-[0.2em]",children:"ÈÅ∏Âèñ‰∏ãËºâÊ™îÊ°à"}),e.jsx("input",{type:"file",accept:"audio/*",ref:r,onChange:pe,className:"hidden"})]})]})}),(l===q.RENDERING||Q||ne)&&e.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#0b0e14] flex flex-col items-center justify-center gap-8 p-12",children:[e.jsx("div",{className:"w-24 h-24 md:w-32 md:h-32 bg-indigo-600 rounded-[2.5rem] flex items-center justify-center text-4xl md:text-5xl shadow-2xl shadow-indigo-600/40 animate-pulse",children:ne?"‚òÅÔ∏è":Q?"üìÅ":"‚öôÔ∏è"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-lg md:text-2xl font-black uppercase tracking-[0.4em]",children:ne?"ËôïÁêÜ‰∏≠":Q?"Â∞àÊ°àËôïÁêÜ‰∏≠":"ÂåØÂá∫‰∏≠"}),!ne&&e.jsxs("span",{className:"text-indigo-400 font-black text-xl tabular-nums",children:[B,"%"]}),ne&&e.jsx("button",{onClick:()=>_(!1),className:"mt-8 px-6 py-2 bg-slate-800 border border-slate-700 rounded-full text-xs font-bold text-slate-400 hover:text-white hover:bg-slate-700 transition-all",children:"ÂèñÊ∂à / ÈóúÈñâ"})]})]}),l===q.FINISHED&&e.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#0b0e14] flex flex-col items-center justify-center gap-6",children:[e.jsx("div",{className:"w-24 h-24 bg-emerald-500 rounded-full flex items-center justify-center text-4xl shadow-2xl shadow-emerald-500/30",children:"‚ú®"}),e.jsx("h2",{className:"text-xl md:text-2xl font-black uppercase tracking-[0.3em]",children:"ÂÆåÊàêÔºÅ"})]})]})},Se=document.getElementById("root");if(!Se)throw new Error("Could not find root element to mount to");const Ze=Ae.createRoot(Se);Ze.render(e.jsx(ke.StrictMode,{children:e.jsx(Je,{})}));export{q as A,G as T};
